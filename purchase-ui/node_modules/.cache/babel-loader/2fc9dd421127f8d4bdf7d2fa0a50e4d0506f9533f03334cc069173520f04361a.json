{"ast":null,"code":"import { useEffect } from \"react\";\nimport { useMutableRef } from \"../../hooks/useMutableRef/useMutableRef\";\nvar getAllParents = function (a) {\n  for (var b = [], c = a; c;) c !== a && b.push(c), c = c.parentNode;\n  return b;\n};\nexport var usePopoverReposition = function (a) {\n  var b = a.isActive,\n    c = a.scrollAnchorRef,\n    d = a.onRequestReposition,\n    e = useMutableRef(d);\n  useEffect(function () {\n    var a = function () {\n      return e.current();\n    };\n    if (b) {\n      window.addEventListener(\"resize\", a);\n      var d = null !== c && void 0 !== c && c.current ? getAllParents(c.current) : [];\n      return d.forEach(function (b) {\n        return b.addEventListener(\"scroll\", a);\n      }), function () {\n        window.removeEventListener(\"resize\", a), d.forEach(function (b) {\n          return b.removeEventListener(\"scroll\", a);\n        });\n      };\n    }\n  }, [c]);\n};","map":{"version":3,"names":["useEffect","useMutableRef","getAllParents","a","b","c","push","parentNode","usePopoverReposition","isActive","scrollAnchorRef","d","onRequestReposition","e","fn","current","window","addEventListener","forEach","removeEventListener"],"sources":["/Users/leonofv/Desktop/purchase-ui/node_modules/@consta/src/components/Popover/usePopoverReposition.ts"],"sourcesContent":["import React, { useEffect } from 'react';\n\nimport { useMutableRef } from '../../hooks/useMutableRef/useMutableRef';\n\nconst getAllParents = (element: HTMLElement): readonly Node[] => {\n  const mutableParents: Node[] = [];\n  let currentNode: Node | null = element;\n\n  while (currentNode) {\n    currentNode !== element && mutableParents.push(currentNode);\n    currentNode = currentNode.parentNode;\n  }\n\n  return mutableParents;\n};\n\n/** Запрос репозиции поповера при ресайзе окна и скролле */\nexport const usePopoverReposition = ({\n  isActive,\n  scrollAnchorRef,\n  onRequestReposition,\n}: {\n  isActive: boolean;\n  /** При скролле родителей этого элемента будет запрашиваться репозиция поповера */\n  scrollAnchorRef: React.RefObject<HTMLElement | null>;\n  onRequestReposition: () => void;\n}) => {\n  const onRequestRepositionRef = useMutableRef(onRequestReposition);\n\n  useEffect(() => {\n    const fn = () => onRequestRepositionRef.current();\n    if (isActive) {\n      window.addEventListener('resize', fn);\n\n      const allParents = scrollAnchorRef?.current\n        ? getAllParents(scrollAnchorRef.current)\n        : [];\n      allParents.forEach((parentEl) => parentEl.addEventListener('scroll', fn));\n\n      return () => {\n        window.removeEventListener('resize', fn);\n\n        allParents.forEach((parentEl) =>\n          parentEl.removeEventListener('scroll', fn),\n        );\n      };\n    }\n    return undefined;\n  }, [scrollAnchorRef]);\n};\n"],"mappings":"AAAA,SAAgBA,SAAhB,QAAiC,OAAjC;AAEA,SAASC,aAAT;AAEA,IAAMC,aAAa,GAAG,SAAAA,CAACC,CAAD,EAA2C;EAAA,SACzDC,CAAsB,GAAG,EADgC,EAE3DC,CAAwB,GAAGF,CAFgC,EAIxDE,CAJwD,GAK7DA,CAAW,KAAKF,CAAhB,IAA2BC,CAAc,CAACE,IAAf,CAAoBD,CAApB,CALkC,EAM7DA,CAAW,GAAGA,CAAW,CAACE,UANmC;EAS/D,OAAOH,CACR;AAAA,CAVD;AAaA,OAAO,IAAMI,oBAAoB,GAAG,SAAAA,CAAAL,CAAA,EAS9B;EAAA,IARJC,CAQI,GAAAD,CAAA,CARJM,QAQI;IAPJJ,CAOI,GAAAF,CAAA,CAPJO,eAOI;IANJC,CAMI,GAAAR,CAAA,CANJS,mBAMI;IACEC,CAAsB,GAAGZ,aAAa,CAACU,CAAD,CADxC;EAGJX,SAAS,CAAC,YAAM;IACd,IAAMG,CAAE,GAAG,SAAAW,CAAA;MAAA,OAAMD,CAAsB,CAACE,OAAvB,EAAN;IAAA,CAAX;IACA,IAAIX,CAAJ,EAAc;MACZY,MAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkCd,CAAlC,CADY;MAGZ,IAAMQ,CAAU,GAAG,SAAAN,CAAe,eAAfA,CAAA,IAAAA,CAAe,CAAEU,OAAjB,GACfb,aAAa,CAACG,CAAe,CAACU,OAAjB,CADE,GAEf,EAFJ;MAKA,OAFAJ,CAAU,CAACO,OAAX,CAAmB,UAACd,CAAD;QAAA,OAAcA,CAAQ,CAACa,gBAAT,CAA0B,QAA1B,EAAoCd,CAApC,CAAd;MAAA,CAAnB,CAEA,EAAO,YAAM;QACXa,MAAM,CAACG,mBAAP,CAA2B,QAA3B,EAAqChB,CAArC,CADW,EAGXQ,CAAU,CAACO,OAAX,CAAmB,UAACd,CAAD;UAAA,OACjBA,CAAQ,CAACe,mBAAT,CAA6B,QAA7B,EAAuChB,CAAvC,CADiB;QAAA,CAAnB,CAGD;MAAA,CACF;IAAA;EAEF,CAnBQ,EAmBN,CAACE,CAAD,CAnBM,CAoBV;AAAA,CAhCM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}