{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport \"./ContextMenuWrapper.css\";\nimport React, { Fragment, useCallback, useState } from \"react\";\nimport { Transition } from \"react-transition-group\";\nimport { cnListBox, mapVerticalSpase } from \"../../ListCanary\";\nimport { Popover } from \"../../Popover\";\nimport { useFlag } from \"../../../hooks/useFlag\";\nimport { useMutableRef } from \"../../../hooks/useMutableRef\";\nimport { animateTimeout, cnMixPopoverAnimate } from \"../../../mixs/MixPopoverAnimate\";\nimport { cnMixSpace } from \"../../../mixs/MixSpace\";\nimport { cn } from \"../../../utils/bem\";\nimport { contextMenuDefaultSize, defaultContextMenuForm } from \"../types\";\nvar cnContextMenuWrapper = cn(\"ContextMenuWrapper\");\nexport var ContextMenuWrapper = function (a) {\n  var b = a.isMobile,\n    c = a.children,\n    d = a.form,\n    e = void 0 === d ? defaultContextMenuForm : d,\n    f = a.isOpen,\n    g = a.size,\n    h = void 0 === g ? contextMenuDefaultSize : g,\n    i = a.anchorRef,\n    j = a.possibleDirections,\n    k = a.position,\n    l = a.direction,\n    m = a.spareDirection,\n    n = a.onClickOutside,\n    o = a.offset,\n    p = a.onSetDirection,\n    q = a.className,\n    r = a.animationBack,\n    s = a.style,\n    t = useFlag(b),\n    u = _slicedToArray(t, 2),\n    v = u[0],\n    w = u[1],\n    x = useState(l),\n    y = _slicedToArray(x, 2),\n    z = y[0],\n    A = y[1],\n    B = useMutableRef(p),\n    C = useCallback(function (a) {\n      var b;\n      A(a), null === (b = B.current) || void 0 === b ? void 0 : b.call(B, a);\n    }, []);\n  return b ? React.createElement(Transition, {\n    timeout: animateTimeout,\n    in: f,\n    unmountOnExit: !0,\n    onEntered: w.on,\n    onExit: w.off\n  }, function (a) {\n    return React.createElement(Popover, {\n      className: cnContextMenuWrapper({\n        animationBack: r,\n        innerAnimation: v\n      }, [cnListBox({\n        size: h,\n        form: e,\n        border: !0,\n        shadow: !0\n      }), cnMixSpace({\n        pV: mapVerticalSpase[h]\n      }), cnMixPopoverAnimate({\n        animate: a\n      }), q]),\n      anchorRef: i,\n      possibleDirections: j,\n      position: k,\n      direction: z,\n      spareDirection: m,\n      onClickOutside: n,\n      offset: o,\n      onSetDirection: C,\n      style: s\n    }, c);\n  }) : React.createElement(Fragment, {\n    key: ContextMenuWrapper.name\n  }, c);\n};","map":{"version":3,"names":["React","Fragment","useCallback","useState","Transition","cnListBox","mapVerticalSpase","Popover","useFlag","useMutableRef","animateTimeout","cnMixPopoverAnimate","cnMixSpace","cn","contextMenuDefaultSize","defaultContextMenuForm","cnContextMenuWrapper","ContextMenuWrapper","a","b","isMobile","c","children","d","form","e","f","isOpen","g","size","h","i","anchorRef","j","possibleDirections","k","position","l","direction","m","spareDirection","n","onClickOutside","o","offset","p","onSetDirection","q","className","r","animationBack","s","style","t","u","_slicedToArray","v","w","x","y","z","A","B","C","current","call","createElement","timeout","in","unmountOnExit","onEntered","on","onExit","off","innerAnimation","border","shadow","pV","animate","key","name"],"sources":["/Users/leonofv/Documents/GitHub/PurchasesProject/purchase-ui/node_modules/@consta/src/components/ContextMenu/ContextMenuWrapper/ContextMenuWrapper.tsx"],"sourcesContent":["import './ContextMenuWrapper.css';\n\nimport React, { Fragment, useCallback, useState } from 'react';\nimport { Transition } from 'react-transition-group';\n\nimport { cnListBox, mapVerticalSpase } from '##/components/ListCanary';\nimport { Direction, Popover } from '##/components/Popover';\nimport { useFlag } from '##/hooks/useFlag';\nimport { useMutableRef } from '##/hooks/useMutableRef';\nimport { animateTimeout, cnMixPopoverAnimate } from '##/mixs/MixPopoverAnimate';\nimport { cnMixSpace } from '##/mixs/MixSpace';\nimport { cn } from '##/utils/bem';\n\nimport {\n  contextMenuDefaultSize,\n  ContextMenuWrapperProps,\n  defaultContextMenuForm,\n} from '../types';\n\nconst cnContextMenuWrapper = cn('ContextMenuWrapper');\n\nexport const ContextMenuWrapper = (props: ContextMenuWrapperProps) => {\n  const {\n    isMobile,\n    children,\n    form = defaultContextMenuForm,\n    isOpen,\n    size = contextMenuDefaultSize,\n    anchorRef,\n    possibleDirections,\n    position,\n    direction: directionProp,\n    spareDirection,\n    onClickOutside,\n    offset,\n    onSetDirection: onSetDirectionProp,\n    className,\n    animationBack,\n    style,\n  } = props;\n\n  const [innerAnimation, setInnerAnimation] = useFlag(isMobile);\n  // запоминаем позицию посднего удовлетворяющего разворота,\n  // для того чтоб следующий экран разворачивался в эту же строну.\n  const [direction, setSirection] = useState(directionProp);\n\n  const onSetDirectionRef = useMutableRef(onSetDirectionProp);\n\n  const onSetDirection = useCallback((direction: Direction) => {\n    setSirection(direction);\n    onSetDirectionRef.current?.(direction);\n  }, []);\n\n  if (isMobile) {\n    return (\n      <Transition\n        timeout={animateTimeout}\n        in={isOpen}\n        unmountOnExit\n        onEntered={setInnerAnimation.on}\n        onExit={setInnerAnimation.off}\n      >\n        {(animate) => (\n          <Popover\n            className={cnContextMenuWrapper({ animationBack, innerAnimation }, [\n              cnListBox({ size, form, border: true, shadow: true }),\n              cnMixSpace({\n                pV: mapVerticalSpase[size],\n              }),\n              cnMixPopoverAnimate({ animate }),\n              className,\n            ])}\n            anchorRef={anchorRef}\n            possibleDirections={possibleDirections}\n            position={position}\n            direction={direction}\n            spareDirection={spareDirection}\n            onClickOutside={onClickOutside}\n            offset={offset}\n            onSetDirection={onSetDirection}\n            style={style}\n          >\n            {children}\n          </Popover>\n        )}\n      </Transition>\n    );\n  }\n\n  return <Fragment key={ContextMenuWrapper.name}>{children}</Fragment>;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}