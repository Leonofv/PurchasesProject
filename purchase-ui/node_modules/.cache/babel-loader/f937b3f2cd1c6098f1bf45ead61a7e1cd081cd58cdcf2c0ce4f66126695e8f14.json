{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nvar Context = createContext({\n  refs: [],\n  zIndex: void 0\n});\nexport function usePortalContext() {\n  return useContext(Context);\n}\nexport var PortalWithThemeProvider = function (a) {\n  var b = useState([]),\n    c = _slicedToArray(b, 2),\n    d = c[0],\n    e = c[1],\n    f = usePortalContext(),\n    g = f.addRefs;\n  return useEffect(function () {\n    g && g(d);\n  }, [d]), useEffect(function () {\n    return function () {\n      return e([]);\n    };\n  }, []), React.createElement(Context.Provider, {\n    value: {\n      refs: d,\n      addRefs: function addRefs(a) {\n        if (0 < a.length) {\n          var b = [].concat(_toConsumableArray(d.filter(function (a) {\n            return a.current;\n          })), _toConsumableArray(a.filter(function (a) {\n            return !!a.current && !d.find(function (b) {\n              return b.current === a.current;\n            });\n          })));\n          e(b);\n        }\n      },\n      zIndex: a.zIndex\n    }\n  }, a.children);\n};","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","Context","refs","zIndex","usePortalContext","PortalWithThemeProvider","a","b","c","_slicedToArray","d","e","f","g","addRefs","createElement","Provider","value","length","concat","_toConsumableArray","filter","current","find","children"],"sources":["/Users/leonofv/Documents/GitHub/PurchasesProject/purchase-ui/node_modules/@consta/src/components/PortalWithTheme/PortalWithThemeContext/PortalWithThemeContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\n\nconst Context = createContext<{\n  refs: React.RefObject<HTMLElement>[];\n  addRefs?: (ref: React.RefObject<HTMLElement>[]) => void;\n  zIndex?: number;\n}>({\n  refs: [],\n  zIndex: undefined,\n});\n\nexport function usePortalContext() {\n  return useContext(Context);\n}\n/**\n * PortalWithThemeProvider\n * нужен для того чтобы получать рефы дочерних порталов и прокидывать их в родительские порталы\n * Это нужно чтобы в компонетах использовать usePortalContext()\n * и получать рефы всех вложенных порталов в компонент, чтобы без ошибочно реализовать onOutsideClick.\n * Проблема заклбчалась в том что при нажатии на любой вложенный портал,\n * компонент думал ччто клик произашел вне компонента и срабатывал onOutsideClick.\n * Сечас когда мы знаем рефы всех вложенных порталов мы можем игнорировать события кликов на вложенных порталах\n */\nexport const PortalWithThemeProvider: React.FC<{\n  zIndex?: number;\n  children?: React.ReactNode;\n}> = (props) => {\n  const [refs, setRefs] = useState<React.RefObject<HTMLElement>[]>([]);\n  const { addRefs: contextAddRefs } = usePortalContext();\n\n  /**\n   * фукция для добавления рефов дочерних порталов\n   * @param {React.RefObject<HTMLElement>[]} addRef массив ссылок\n   */\n  const addRefs = (addRef: React.RefObject<HTMLElement>[]) => {\n    if (addRef.length > 0) {\n      const newRefs = [\n        ...refs.filter((item) => item.current),\n        ...addRef.filter((addItem) => {\n          if (!addItem.current) {\n            return false;\n          }\n          return !refs.find((item) => item.current === addItem.current);\n        }),\n      ];\n      setRefs(newRefs);\n    }\n  };\n\n  /**\n   * при изменении дочерних рефов необходимо добавить их в родительские порталы\n   */\n  useEffect(() => {\n    contextAddRefs && contextAddRefs(refs);\n  }, [refs]);\n\n  useEffect(() => () => setRefs([]), []);\n\n  return (\n    // eslint-disable-next-line react/jsx-no-constructed-context-values\n    <Context.Provider value={{ refs, addRefs, zIndex: props.zIndex }}>\n      {props.children}\n    </Context.Provider>\n  );\n};\n"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,UAA/B,EAA2CC,SAA3C,EAAsDC,QAAtD,QAAsE,OAAtE;AAEA,IAAMC,OAAO,GAAGJ,aAAa,CAI1B;EACDK,IAAI,EAAE,EADL;EAEDC,MAAM;AAFL,CAJ0B,CAA7B;AASA,OAAO,SAASC,gBAATA,CAAA,EAA4B;EACjC,OAAON,UAAU,CAACG,OAAD,CAClB;AAAA;AAUD,OAAO,IAAMI,uBAGX,GAAG,SAAAA,CAACC,CAAD,EAAW;EAAA,IAAAC,CAAA,GACUP,QAAQ,CAAiC,EAAjC,CADlB;IAAAQ,CAAA,GAAAC,cAAA,CAAAF,CAAA;IACPG,CADO,GAAAF,CAAA;IACDG,CADC,GAAAH,CAAA;IAAAI,CAAA,GAEsBR,gBAAgB,EAFtC;IAEGS,CAFH,GAAAD,CAAA,CAENE,OAFM;EAgCd,OANAf,SAAS,CAAC,YAAM;IACdc,CAAc,IAAIA,CAAc,CAACH,CAAD,CACjC;EAAA,CAFQ,EAEN,CAACA,CAAD,CAFM,CAMT,EAFAX,SAAS,CAAC;IAAA,OAAM;MAAA,OAAMY,CAAO,CAAC,EAAD,CAAb;IAAA,CAAN;EAAA,CAAD,EAA0B,EAA1B,CAET,EAEEf,KAAA,CAAAmB,aAAA,CAACd,OAAD,CAASe,QAAT;IAAkBC,KAAK,EAAE;MAAEf,IAAI,EAAJQ,CAAF;MAAQI,OAAO,EA1B1B,SAAVA,OAAUA,CAACR,CAAD,EAA4C;QAC1D,IAAoB,CAAhB,GAAAA,CAAM,CAACY,MAAX,EAAuB;UACrB,IAAMX,CAAO,MAAAY,MAAA,CAAAC,kBAAA,CACRV,CAAI,CAACW,MAAL,CAAY,UAACf,CAAD;YAAA,OAAUA,CAAI,CAACgB,OAAf;UAAA,CAAZ,CADQ,GAAAF,kBAAA,CAERd,CAAM,CAACe,MAAP,CAAc,UAACf,CAAD,EAAa;YAAA,SACvBA,CAAO,CAACgB,OADe,IAIrB,CAACZ,CAAI,CAACa,IAAL,CAAU,UAAChB,CAAD;cAAA,OAAUA,CAAI,CAACe,OAAL,KAAiBhB,CAAO,CAACgB,OAAnC;YAAA,CAAV,CACT;UAAA,CALE,CAFQ,EAAb;UASAX,CAAO,CAACJ,CAAD,CACR;QAAA;MACF,CAa0B;MAAiBJ,MAAM,EAAEG,CAAK,CAACH;IAA/B;EAAzB,GACGG,CAAK,CAACkB,QADT,CAIH;AAAA,CAzCM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}