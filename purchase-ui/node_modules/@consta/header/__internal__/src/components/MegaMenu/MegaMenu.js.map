{"version":3,"file":"MegaMenu.js","names":["IconArrowRight","React","useCallback","useEffect","useMemo","useState","cn","getItemsDepth","separateItemsByDepth","withDefaultGetters","MegaMenuBannerBar","MegaMenuGlobal","MegaMenuNavBar","cnMegaMenu","MegaMenu","props","b","items","itemsProp","menuHideButtonText","menuMaxElements","menuShowButtonText","menuTitle","onItemClick","onItemClickProp","getItemAs","getItemKey","getItemAttributes","getItemSubMenu","getItemIconLeft","getItemLabel","getItemOnClick","banners","bannerPosition","onBannerClick","getBannerAs","getBannerAttributes","getBannerDescription","getBannerImage","getBannerLabel","getBannerOnClick","className","otherProps","_objectWithoutProperties","_excluded","activeItem","setActiveItem","getItemActive","item","depth","firstLevel","secondLevel","thirdLevel","navItems","groups","handleNavBarClick","e","handleNavBarMouseEnter","c","onMouseEnter","createElement","Object","assign","withGlobalMenu","withBannersBar","length","withNavBar","_objectSpread","getItemIconRight","title","getGroupKey","getGroupLabel","getItemGroupId","groupId","getGroupOnClick","onGroupClick","maxElements","showButtonText","hideButtonText","view","getItemDescription","getItemImage"],"sources":["../../../../../src/components/MegaMenu/MegaMenu.tsx"],"sourcesContent":["import './MegaMenu.css';\n\nimport { IconArrowRight } from '@consta/icons/IconArrowRight';\nimport { AsTagAttribute } from '@consta/uikit/__internal__/src/utils/types/AsTags';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { cn } from '##/utils/bem';\n\nimport {\n  getItemsDepth,\n  separateItemsByDepth,\n  withDefaultGetters,\n} from './helper';\nimport { MegaMenuBannerBar } from './MegaMenuBannerBar';\nimport { MegaMenuGlobal } from './MegaMenuGlobal';\nimport { MegaMenuNavBar } from './MegaMenuNavBar';\nimport { MegaMenuProps } from './types';\n\nconst cnMegaMenu = cn('MegaMenu');\n\nexport const MegaMenu = (props: MegaMenuProps) => {\n  const {\n    // GlobalMenu\n    items: itemsProp,\n    menuHideButtonText = 'Скрыть',\n    menuMaxElements,\n    menuShowButtonText = 'Ещё',\n    menuTitle,\n    onItemClick: onItemClickProp,\n    getItemAs,\n    getItemKey,\n    getItemAttributes,\n    getItemSubMenu,\n    getItemIconLeft,\n    getItemLabel,\n    getItemOnClick,\n    // BannerBar\n    banners,\n    bannerPosition = 'right',\n    onBannerClick,\n    getBannerAs,\n    getBannerAttributes,\n    getBannerDescription,\n    getBannerImage,\n    getBannerLabel,\n    getBannerOnClick,\n    // Others\n    className,\n    ...otherProps\n  } = withDefaultGetters(props);\n  type ITEM = (typeof itemsProp)[number];\n\n  const [activeItem, setActiveItem] = useState<ITEM | undefined>();\n\n  const getItemActive = useCallback(\n    (item: ITEM) =>\n      activeItem ? getItemKey(activeItem) === getItemKey(item) : false,\n    [activeItem],\n  );\n\n  const depth = useMemo(\n    () => getItemsDepth(itemsProp, getItemSubMenu),\n    [itemsProp],\n  );\n\n  const [firstLevel, secondLevel, thirdLevel] = useMemo(\n    () =>\n      separateItemsByDepth({\n        items: itemsProp,\n        getItemKey,\n        getItemSubMenu,\n        getItemActive,\n        depth,\n      }),\n    [itemsProp, activeItem],\n  );\n\n  const { navItems, items, groups } = useMemo(() => {\n    return {\n      navItems: depth < 2 || depth > 2 ? firstLevel : undefined,\n      groups: depth < 3 ? firstLevel : secondLevel,\n      items: depth < 3 ? secondLevel : thirdLevel,\n    };\n  }, [depth, firstLevel, secondLevel, thirdLevel]);\n\n  const handleNavBarClick = (e: React.MouseEvent, item: ITEM) => {\n    onItemClickProp?.(item, { e });\n    if (getItemSubMenu(item)) {\n      setActiveItem(item);\n    }\n  };\n\n  const handleNavBarMouseEnter = (\n    e: React.MouseEvent<HTMLDivElement>,\n    item: ITEM,\n  ) => {\n    const onMouseEnter = getItemAttributes(item)\n      ?.onMouseEnter as AsTagAttribute<'div'>['onMouseEnter'];\n    onMouseEnter?.(e);\n    if (getItemSubMenu(item)) {\n      setActiveItem(item);\n    }\n  };\n\n  useEffect(() => {\n    if (depth > 2 && getItemSubMenu(itemsProp[0])) {\n      setActiveItem(itemsProp[0]);\n    }\n  }, [depth]);\n\n  return (\n    <div\n      className={cnMegaMenu(\n        {\n          withGlobalMenu: depth > 1,\n          withBannersBar: (banners ?? []).length > 0,\n          withNavBar: depth !== 2,\n          bannerPosition,\n        },\n        [className],\n      )}\n      {...otherProps}\n    >\n      {navItems && (\n        <MegaMenuNavBar\n          items={navItems}\n          className={cnMegaMenu('NavBar')}\n          getItemActive={({ item }) => getItemActive(item)}\n          getItemAs={({ item }) => getItemAs(item)}\n          getItemAttributes={({ item }) =>\n            ({\n              ...getItemAttributes(item),\n              onMouseEnter: (e: React.MouseEvent<HTMLDivElement>) =>\n                handleNavBarMouseEnter(e, item),\n            } as AsTagAttribute<'div'>)\n          }\n          getItemIconLeft={({ item }) => getItemIconLeft(item)}\n          getItemLabel={({ item }) => getItemLabel(item)}\n          getItemOnClick={({ item }) => getItemOnClick(item)}\n          onItemClick={({ item }, { e }) => handleNavBarClick(e, item)}\n          getItemIconRight={({ item }) =>\n            getItemSubMenu(item) ? IconArrowRight : undefined\n          }\n        />\n      )}\n      <div className={cnMegaMenu('Wrapper')}>\n        {depth >= 2 && (\n          <MegaMenuGlobal\n            className={cnMegaMenu('GlobalMenu')}\n            items={items}\n            groups={groups}\n            title={\n              menuTitle ?? (activeItem ? getItemLabel(activeItem) : undefined)\n            }\n            getGroupKey={({ item }) => getItemKey(item)}\n            getGroupLabel={({ item }) => getItemLabel(item)}\n            getItemAs={({ item }) => getItemAs(item)}\n            getItemAttributes={({ item }) => getItemAttributes(item)}\n            getItemGroupId={({ groupId }) => groupId}\n            getItemLabel={({ item }) => getItemLabel(item)}\n            getItemOnClick={({ item }) => getItemOnClick(item)}\n            getGroupOnClick={({ item }) => getItemOnClick(item)}\n            onGroupClick={\n              onItemClickProp\n                ? ({ item }, { e }) => {\n                    onItemClickProp?.(item, { e });\n                  }\n                : undefined\n            }\n            onItemClick={\n              onItemClickProp\n                ? ({ item }, { e }) => onItemClickProp?.(item, { e })\n                : undefined\n            }\n            maxElements={menuMaxElements}\n            showButtonText={menuShowButtonText}\n            hideButtonText={menuHideButtonText}\n          />\n        )}\n        {banners && (\n          <MegaMenuBannerBar\n            className={cnMegaMenu('BannerBar')}\n            items={banners}\n            view={bannerPosition === 'right' ? 'vertical' : 'horizontal'}\n            onItemClick={onBannerClick}\n            getItemAs={getBannerAs}\n            getItemAttributes={getBannerAttributes}\n            getItemDescription={getBannerDescription}\n            getItemImage={getBannerImage}\n            getItemLabel={getBannerLabel}\n            getItemOnClick={getBannerOnClick}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport * from './types';\n"],"mappings":"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"}