{"version":3,"file":"SelectMenu.js","names":["IconSelect","ContextMenu","Text","useFlag","useForkRef","useMutableRef","React","forwardRef","useCallback","useRef","getItemClick","cn","withDefaultGetters","cnSelectMenu","SelectMenuRender","props","componentRef","c","items","className","getItemHref","getItemLabel","getItemOnClick","getItemTarget","onItemClick","label","onClick","onClickProp","getItemSubMenu","style","otherProps","_objectWithoutProperties","_excluded","open","setOpen","ref","getItemHrefRef","getItemTargetRef","onClickRef","getItemAs","item","current","getItemHTMLAttributes","href","target","_objectSpread","e","b","call","toggle","createElement","Fragment","Object","assign","size","view","lineHeight","anchorRef","isOpen","getItemAttributes","onClickOutside","off","direction","possibleDirections","zIndex","SelectMenu"],"sources":["../../../../../src/components/SelectMenu/SelectMenu.tsx"],"sourcesContent":["/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport './SelectMenu.css';\n\nimport { IconSelect } from '@consta/icons/IconSelect';\nimport { ContextMenu } from '@consta/uikit/ContextMenu';\nimport { Text } from '@consta/uikit/Text';\nimport { useFlag } from '@consta/uikit/useFlag';\nimport { useForkRef } from '@consta/uikit/useForkRef';\nimport { useMutableRef } from '@consta/uikit/useMutableRef';\nimport React, { forwardRef, useCallback, useRef } from 'react';\n\nimport { getItemClick } from '##/helpers/getItemClick';\nimport { cn } from '##/utils/bem';\n\nimport { withDefaultGetters } from './helpers';\nimport {\n  SelectMenuComponent,\n  SelectMenuDefaultItem,\n  SelectMenuProps,\n} from './types';\n\nexport const cnSelectMenu = cn('SelectMenu');\n\nconst SelectMenuRender = (\n  props: SelectMenuProps,\n  componentRef: React.Ref<HTMLDivElement>,\n) => {\n  const {\n    items,\n    className,\n    getItemHref,\n    getItemLabel,\n    getItemOnClick,\n    getItemTarget,\n    onItemClick,\n    label,\n    onClick: onClickProp,\n    getItemSubMenu,\n    style,\n    ...otherProps\n  } = withDefaultGetters(props);\n\n  const [open, setOpen] = useFlag();\n\n  const ref = useRef<HTMLDivElement>(null);\n\n  const getItemHrefRef = useMutableRef(getItemHref);\n  const getItemTargetRef = useMutableRef(getItemTarget);\n  const onClickRef = useMutableRef(onClickProp);\n\n  const getItemAs = useCallback(\n    (item: SelectMenuDefaultItem) =>\n      getItemHrefRef.current(item) ? 'a' : 'span',\n    [],\n  );\n\n  const getItemHTMLAttributes = useCallback((item: SelectMenuDefaultItem) => {\n    const href = getItemHrefRef.current(item);\n    const target = getItemTargetRef.current(item);\n\n    return {\n      ...(href && { href: getItemHrefRef.current(item) }),\n      ...(target && { href: getItemTargetRef.current(item) }),\n    };\n  }, []);\n\n  const onClick = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\n    onClickRef.current?.(e);\n    setOpen.toggle();\n  }, []);\n\n  return (\n    <>\n      <div\n        {...otherProps}\n        className={cnSelectMenu(null, [className])}\n        ref={useForkRef([ref, componentRef])}\n        onClick={onClick}\n        style={style}\n      >\n        <Text\n          className={cnSelectMenu('Label')}\n          size=\"s\"\n          view=\"primary\"\n          lineHeight=\"m\"\n        >\n          {label}\n        </Text>\n        <span className={cnSelectMenu('ArrowBox', { open })}>\n          <IconSelect size=\"xs\" />\n        </span>\n      </div>\n      {items && (\n        <ContextMenu\n          className={cnSelectMenu('Menu')}\n          anchorRef={ref}\n          isOpen={open}\n          items={items}\n          getItemLabel={getItemLabel}\n          getItemAs={getItemAs}\n          getItemAttributes={getItemHTMLAttributes}\n          onClickOutside={setOpen.off}\n          onItemClick={(item, { e }) =>\n            getItemClick(item, getItemOnClick, onItemClick)(e)\n          }\n          direction=\"rightStartDown\"\n          possibleDirections={[\n            'downStartLeft',\n            'upStartLeft',\n            'downStartRight',\n            'upStartRight',\n          ]}\n          getItemSubMenu={getItemSubMenu}\n          style={{\n            zIndex:\n              typeof style?.zIndex === 'number' ? style.zIndex + 1 : 'auto',\n          }}\n        />\n      )}\n    </>\n  );\n};\n\nexport const SelectMenu = forwardRef(SelectMenuRender) as SelectMenuComponent;\n\nexport * from './types';\n"],"mappings":"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"}