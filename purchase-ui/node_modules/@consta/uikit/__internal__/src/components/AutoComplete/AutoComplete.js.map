{"version":3,"file":"AutoComplete.js","names":["React","useCallback","useRef","SelectDropdown","SelectItem","defaultPropForm","defaultPropSize","defaultPropView","TextField","useForkRef","useMutableRef","cn","withDefaultGetters","useAutoComplete","cnAutoComplete","AutoCompleteRender","props","ref","defaultDropdownRef","controlRef","containerRef","items","groups","disabled","getItemLabel","getItemKey","isLoading","getItemGroupKey","getGroupKey","getGroupLabel","onBlur","inputRef","onFocus","dropdownRef","dropdownClassName","dropdownForm","value","form","view","size","onChange","inputContainerRef","style","renderItem","searchFunction","id","name","className","virtualScroll","onScrollToBottom","onDropdownOpen","dropdownOpen","ignoreOutsideClicksRefs","otherProps","onChangeRef","handleSelectChange","e","copyEvent","newValue","current","toString","handleInputChange","searchValue","getOptionProps","isOpen","getKeyProps","visibleItems","handleInputFocus","handleInputBlur","inputControlRef","optionsRefs","renderItemDefault","item","active","hovered","onClick","onMouseEnter","length","zIndex","AutoComplete","forwardRef"],"sources":["../../../../../src/components/AutoComplete/AutoComplete.tsx"],"sourcesContent":["import React, { useCallback, useRef } from 'react';\n\nimport { PropRenderItem } from '##/components/Select';\nimport { SelectDropdown } from '##/components/SelectComponents/SelectDropdown';\nimport { SelectItem } from '##/components/SelectComponents/SelectItem';\nimport {\n  defaultPropForm,\n  defaultPropSize,\n  defaultPropView,\n} from '##/components/SelectComponentsDeprecated/types';\nimport {\n  TextField,\n  TextFieldPropOnChange,\n} from '##/components/TextField/TextField';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { useMutableRef } from '##/hooks/useMutableRef';\nimport { cn } from '##/utils/bem';\n\nimport { withDefaultGetters } from './helpers';\nimport {\n  AutoCompleteComponent,\n  AutoCompleteGroupDefault,\n  AutoCompleteItemDefault,\n  AutoCompleteProps,\n} from './types';\nimport { useAutoComplete } from './useAutoComplete';\n\nconst cnAutoComplete = cn('AutoComplete');\n\nconst AutoCompleteRender = <\n  TYPE extends string,\n  ITEM = AutoCompleteItemDefault,\n  GROUP = AutoCompleteGroupDefault,\n>(\n  props: AutoCompleteProps<TYPE, ITEM, GROUP>,\n  ref: React.Ref<HTMLDivElement>,\n) => {\n  const defaultDropdownRef = useRef<HTMLDivElement | null>(null);\n  const controlRef = useRef<HTMLDivElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const {\n    items,\n    groups = [],\n    disabled,\n    getItemLabel,\n    getItemKey,\n    isLoading,\n    getItemGroupKey,\n    getGroupKey,\n    getGroupLabel,\n    onBlur,\n    inputRef,\n    onFocus,\n    dropdownRef = defaultDropdownRef,\n    dropdownClassName,\n    dropdownForm = 'default',\n    value,\n    form = defaultPropForm,\n    view = defaultPropView,\n    size = defaultPropSize,\n    onChange,\n    inputContainerRef,\n    style,\n    renderItem,\n    searchFunction,\n    id,\n    name,\n    className,\n    virtualScroll,\n    onScrollToBottom,\n    onDropdownOpen,\n    dropdownOpen,\n    ignoreOutsideClicksRefs,\n    ...otherProps\n  } = withDefaultGetters(props);\n\n  const onChangeRef = useMutableRef(onChange);\n\n  const handleSelectChange = useCallback(\n    ({ e, value }: { value: ITEM | null; e: React.SyntheticEvent }) => {\n      const copyEvent = { ...e } as React.KeyboardEvent;\n      const newValue = (value ? getItemLabel(value) : value) as string;\n      onChangeRef.current?.(newValue, {\n        e: copyEvent,\n        id: id?.toString(),\n        name,\n      });\n    },\n    [id, name],\n  );\n\n  const handleInputChange: TextFieldPropOnChange = useCallback(\n    (value, { id, name, e }) => {\n      onChangeRef.current?.(value, { id: id?.toString(), name, e });\n    },\n    [],\n  );\n\n  const {\n    getOptionProps,\n    isOpen,\n    getKeyProps,\n    visibleItems,\n    handleInputFocus,\n    handleInputBlur,\n    inputRef: inputControlRef,\n    optionsRefs,\n  } = useAutoComplete({\n    items,\n    groups,\n    onChange: handleSelectChange,\n    dropdownRef,\n    controlRef,\n    disabled,\n    searchValue: value ?? '',\n    getItemLabel,\n    getItemKey,\n    getItemGroupKey,\n    getGroupKey,\n    onBlur,\n    onFocus,\n    searchFunction,\n    isLoading,\n    onDropdownOpen,\n    dropdownOpen,\n    ignoreOutsideClicksRefs,\n  });\n\n  const renderItemDefault: PropRenderItem<ITEM> = (props) => {\n    const { item, active, hovered, onClick, onMouseEnter, ref } = props;\n\n    return (\n      <SelectItem\n        label={getItemLabel(item)}\n        active={active}\n        hovered={hovered}\n        multiple={false}\n        disabled={disabled}\n        size={size}\n        indent={dropdownForm === 'round' ? 'increased' : 'normal'}\n        onClick={onClick}\n        onMouseEnter={onMouseEnter}\n        ref={ref}\n      />\n    );\n  };\n\n  return (\n    <>\n      <TextField\n        {...getKeyProps()}\n        form={form}\n        view={view}\n        id={id}\n        className={cnAutoComplete(null, [className])}\n        name={name}\n        disabled={disabled}\n        ref={useForkRef([controlRef, ref])}\n        inputRef={useForkRef([inputRef, inputControlRef])}\n        onBlur={handleInputBlur}\n        inputContainerRef={useForkRef([containerRef, inputContainerRef])}\n        onClick={handleInputFocus}\n        onChange={handleInputChange}\n        value={value}\n        style={style}\n        size={size}\n        {...otherProps}\n      />\n      <SelectDropdown\n        isOpen={isOpen}\n        size={size}\n        controlRef={containerRef}\n        getOptionProps={getOptionProps}\n        dropdownRef={dropdownRef}\n        form={dropdownForm}\n        className={cnAutoComplete('List', [dropdownClassName])}\n        renderItem={renderItem || renderItemDefault}\n        getGroupLabel={getGroupLabel}\n        visibleItems={visibleItems}\n        isLoading={isLoading}\n        hasItems={items.length !== 0}\n        itemsRefs={optionsRefs}\n        virtualScroll\n        style={\n          typeof style?.zIndex === 'number'\n            ? { zIndex: style.zIndex + 1 }\n            : undefined\n        }\n        onScrollToBottom={onScrollToBottom}\n      />\n    </>\n  );\n};\n\nexport const AutoComplete = React.forwardRef(\n  AutoCompleteRender,\n) as AutoCompleteComponent;\n\nexport * from './types';\n"],"mappings":"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"}