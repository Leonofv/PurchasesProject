{"version":3,"file":"BookmarkTabs.js","names":["IconAdd","IconArrowLeft","IconArrowRight","React","forwardRef","useMemo","useState","useComponentSize","useForkRef","cnMixScrollBar","cn","Button","BookmarkTabsTab","withDefaultGetters","bookmarkTabsPropFormDefault","bookmarkTabsPropSizeDefault","bookmarkTabsPropViewDefault","useBookmarkTabs","cnBookmarkTabs","renderItemDefault","props","_item","item","attributes","as","otherProps","BookmarkTabsRender","ref","items","value","onCreate","getItemKey","getItemLabel","getItemLeftIcon","getItemRightIcon","getItemAs","getItemRef","getItemAttributes","getItemFixed","onChange","onRemove","renderItem","renderItemProp","size","form","view","withNavigationButtons","onMouseLeaveProp","onMouseLeave","className","id","higlightedIndex","setHighlitedIndex","getItemActive","withAddButton","refs","fixedTabs","fixedTabsRef","otherTabs","otherTabsRef","showControls","wrapperRef","containerRef","controlsRef","addButtonRef","navigate","sizes","fixedWidth","width","fixed","controlRef","bordered","index","tabWidth","onClick","e","active","label","leftIcon","rightIcon","tabRef","onClose","hovered","borderedIndexes","arr","activeIndex","indexOf","Array","from","length","keys","filter","el","invisible","map","includes","type","BookmarkTabs"],"sources":["../../../../../src/components/BookmarkTabs/BookmarkTabs.tsx"],"sourcesContent":["import './BookmarkTabs.css';\n\nimport { IconAdd } from '@consta/icons/IconAdd';\nimport { IconArrowLeft } from '@consta/icons/IconArrowLeft';\nimport { IconArrowRight } from '@consta/icons/IconArrowRight';\nimport React, { forwardRef, useMemo, useState } from 'react';\n\nimport { useComponentSize } from '##/hooks/useComponentSize';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { cnMixScrollBar } from '##/mixs/MixScrollBar';\nimport { cn } from '##/utils/bem';\n\nimport { Button } from '../Button';\nimport { BookmarkTabsTab } from './BookmarkTabsTab';\nimport { withDefaultGetters } from './helper';\nimport {\n  BookmarkTabsComponent,\n  bookmarkTabsPropFormDefault,\n  BookmarkTabsProps,\n  bookmarkTabsPropSizeDefault,\n  bookmarkTabsPropViewDefault,\n  BookmarkTabsRenderItemProps,\n} from './types';\nimport { useBookmarkTabs } from './useBookmarkTabs';\n\nexport const cnBookmarkTabs = cn('BookmarkTabs');\n\nconst renderItemDefault = <ITEM,>(\n  props: BookmarkTabsRenderItemProps<ITEM>,\n): React.ReactElement => {\n  const { item: _item, attributes = {}, as, ...otherProps } = props;\n  return <BookmarkTabsTab {...attributes} {...otherProps} as={as} />;\n};\n\nconst BookmarkTabsRender = (\n  props: BookmarkTabsProps,\n  ref: React.Ref<HTMLDivElement>,\n) => {\n  const {\n    items = [],\n    value,\n    onCreate,\n    getItemKey,\n    getItemLabel,\n    getItemLeftIcon,\n    getItemRightIcon,\n    getItemAs,\n    getItemRef,\n    getItemAttributes,\n    getItemFixed,\n    onChange,\n    onRemove,\n    renderItem: renderItemProp = renderItemDefault,\n    size = bookmarkTabsPropSizeDefault,\n    form = bookmarkTabsPropFormDefault,\n    view = bookmarkTabsPropViewDefault,\n    withNavigationButtons,\n    onMouseLeave: onMouseLeaveProp,\n    className,\n    id,\n    ...otherProps\n  } = withDefaultGetters(props);\n\n  const [higlightedIndex, setHighlitedIndex] = useState<number | null>(null);\n\n  type Item = typeof items[number];\n\n  const getItemActive = (item: Item) => {\n    return value ? getItemKey(item) === getItemKey(value) : false;\n  };\n\n  const {\n    refs,\n    fixedTabs,\n    fixedTabsRef,\n    otherTabs,\n    otherTabsRef,\n    showControls,\n    wrapperRef,\n    containerRef,\n    controlsRef,\n    addButtonRef,\n    navigate,\n    sizes,\n  } = useBookmarkTabs({\n    items,\n    getItemFixed,\n    size,\n    withNavigationButtons,\n    withAddButton: !!onCreate,\n  });\n\n  const { width: fixedWidth } = useComponentSize(fixedTabsRef);\n\n  const renderItem = (\n    item: Item,\n    fixed: boolean,\n    controlRef: React.RefObject<HTMLDivElement>,\n    bordered: boolean,\n    index: number,\n    tabWidth?: string,\n  ) => (\n    <div\n      className={cnBookmarkTabs('Tab')}\n      onMouseEnter={() => setHighlitedIndex(index)}\n      onFocus={() => setHighlitedIndex(index)}\n      ref={controlRef}\n    >\n      {renderItemProp({\n        item,\n        onClick: (e) => onChange?.(item, { e }),\n        active: getItemActive(item),\n        label: getItemLabel(item),\n        leftIcon: getItemLeftIcon(item),\n        rightIcon: getItemRightIcon(item),\n        as: getItemAs(item) ?? 'div',\n        attributes: getItemAttributes(item),\n        tabRef: getItemRef(item),\n        fixed,\n        bordered,\n        onClose: onRemove ? (e) => onRemove(item, { e }) : undefined,\n        size,\n        view,\n        hovered: higlightedIndex === index,\n        form,\n        tabWidth,\n      })}\n    </div>\n  );\n\n  const onMouseLeave: React.MouseEventHandler<HTMLDivElement> = (e) => {\n    onMouseLeaveProp?.(e);\n    setHighlitedIndex(null);\n  };\n\n  const borderedIndexes = useMemo(() => {\n    const arr = [...fixedTabs, ...otherTabs];\n    const activeIndex = value ? arr.indexOf(value) : -1;\n    return Array.from(Array(arr.length - 1).keys()).filter((el) =>\n      form === 'round' ? el !== activeIndex && el !== activeIndex - 1 : true,\n    );\n  }, [fixedTabs, otherTabs, value, form]);\n\n  return (\n    <div\n      className={cnBookmarkTabs({ size, view, form }, [className])}\n      ref={useForkRef([ref, containerRef])}\n      id={id}\n      onMouseLeave={onMouseLeave}\n      {...otherProps}\n    >\n      {showControls && (\n        <div ref={controlsRef} className={cnBookmarkTabs('ScrollControls')}>\n          <div className={cnBookmarkTabs('Button')}>\n            <Button\n              view=\"clear\"\n              size=\"xs\"\n              type=\"button\"\n              onClick={() => navigate('prev')}\n              iconLeft={IconArrowLeft}\n              onlyIcon\n            />\n          </div>\n          <div className={cnBookmarkTabs('Button')}>\n            <Button\n              view=\"clear\"\n              size=\"xs\"\n              type=\"button\"\n              onClick={() => navigate('next')}\n              iconLeft={IconArrowRight}\n              onlyIcon\n            />\n          </div>\n        </div>\n      )}\n      <div\n        ref={wrapperRef}\n        className={cnBookmarkTabs(\n          'Wrapper',\n          cnMixScrollBar({ invisible: true }),\n        )}\n      >\n        <div\n          style={{\n            ['--bookmarks-list-width' as string]: `max-content`,\n          }}\n          ref={fixedTabsRef}\n          className={cnBookmarkTabs('List')}\n        >\n          {fixedTabs.map((item, index) => (\n            <React.Fragment key={getItemKey(item)}>\n              {renderItem(\n                item,\n                true,\n                refs[index],\n                borderedIndexes.includes(index),\n                index,\n              )}\n            </React.Fragment>\n          ))}\n        </div>\n        <div\n          style={{\n            ['--bookmarks-list-width' as string]: `calc(100% - ${fixedWidth}px)`,\n          }}\n          className={cnBookmarkTabs('List')}\n          ref={otherTabsRef}\n        >\n          {otherTabs.map((item, index) => {\n            const { length } = fixedTabs;\n            return (\n              <React.Fragment key={getItemKey(item)}>\n                {renderItem(\n                  item,\n                  false,\n                  refs[length + index],\n                  borderedIndexes.includes(length + index),\n                  length + index,\n                  sizes[index],\n                )}\n              </React.Fragment>\n            );\n          })}\n        </div>\n      </div>\n      {onCreate && (\n        <div\n          ref={addButtonRef}\n          className={cnBookmarkTabs('Button', { type: 'add' })}\n        >\n          <Button\n            view=\"clear\"\n            size=\"xs\"\n            type=\"button\"\n            onClick={onCreate}\n            iconLeft={IconAdd}\n            onlyIcon\n          />\n        </div>\n      )}\n      <div className={cnBookmarkTabs('Empty')} />\n    </div>\n  );\n};\n\nexport const BookmarkTabs = forwardRef(\n  BookmarkTabsRender,\n) as BookmarkTabsComponent;\n"],"mappings":"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"}