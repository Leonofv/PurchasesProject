{"version":3,"file":"useBookmarkTabs.js","names":["useLayoutEffect","useMemo","useState","useRefs","MAX_TAB_SIZE","useBookmarkTabs","props","items","getItemFixed","withNavigationButtons","refs","length","wrapperRef","containerRef","fixedTabsRef","otherTabsRef","controlsRef","addButtonRef","sizes","setSizes","showControls","setShowControls","fixedTabs","otherTabs","forEach","item","push","ref","resizeObserver","ResizeObserver","containerWidth","current","offsetWidth","fixedWidth","scrollWidth","otherWidth","itemSize","Math","min","Array","from","fill","observe","disconnect","navigate","type","container","i","offsetLeft","scrollLeft","index","node","scrollTo","left","behavior"],"sources":["../../../../../src/components/BookmarkTabs/useBookmarkTabs.ts"],"sourcesContent":["import { useLayoutEffect, useMemo, useState } from 'react';\n\nimport { useRefs } from '##/hooks/useRefs';\n\nimport {\n  BookmarkTabsItemDefault,\n  BookmarkTabsPropGetItemFixed,\n  BookmarkTabsPropSize,\n} from './types';\n\ntype UseBookmarkTabsProps<ITEM = BookmarkTabsItemDefault> = {\n  items: ITEM[];\n  getItemFixed: BookmarkTabsPropGetItemFixed<ITEM>;\n  withNavigationButtons?: boolean;\n  withAddButton?: boolean;\n  size: BookmarkTabsPropSize;\n};\n\nconst MAX_TAB_SIZE = 200;\n\nexport const useBookmarkTabs = <ITEM>(props: UseBookmarkTabsProps<ITEM>) => {\n  const { items, getItemFixed, withNavigationButtons } = props;\n\n  const refs = useRefs<HTMLDivElement>(items.length);\n\n  const [\n    wrapperRef,\n    containerRef,\n    fixedTabsRef,\n    otherTabsRef,\n    controlsRef,\n    addButtonRef,\n  ] = useRefs<HTMLDivElement>(6);\n\n  const [sizes, setSizes] = useState<string[]>([]);\n\n  const [showControls, setShowControls] = useState(false);\n\n  const { fixedTabs, otherTabs } = useMemo(() => {\n    const fixedTabs: ITEM[] = [];\n    const otherTabs: ITEM[] = [];\n\n    items.forEach((item) => {\n      if (getItemFixed(item)) {\n        fixedTabs.push(item);\n      } else {\n        otherTabs.push(item);\n      }\n    });\n\n    return {\n      fixedTabs,\n      otherTabs,\n    };\n  }, [items, getItemFixed]);\n\n  const navigate = (type: 'next' | 'prev') => {\n    const container = wrapperRef.current;\n    if (container) {\n      for (let i = 0; i < refs.length; i++) {\n        const ref = refs[i];\n        if (ref.current) {\n          if (\n            ref.current.offsetLeft >=\n            container.offsetLeft + container.scrollLeft\n          ) {\n            const index = i + (type === 'next' ? 1 : -1);\n            const node = refs[index]?.current;\n            if (node) {\n              container.scrollTo({\n                left: node.offsetLeft - container.offsetLeft,\n                behavior: 'smooth',\n              });\n            }\n            return;\n          }\n        }\n      }\n    }\n  };\n\n  useLayoutEffect(() => {\n    const refs = [\n      containerRef,\n      fixedTabsRef,\n      wrapperRef,\n      otherTabsRef,\n      controlsRef,\n    ];\n    const resizeObserver = new ResizeObserver(() => {\n      const containerWidth = containerRef.current?.offsetWidth ?? 0;\n      const fixedWidth = fixedTabsRef.current?.offsetWidth ?? 0;\n\n      const showControls =\n        (fixedTabsRef.current?.scrollWidth ?? 0) +\n          (otherTabsRef.current?.scrollWidth ?? 0) >\n          containerWidth - (addButtonRef.current?.offsetWidth ?? 0) &&\n        !!withNavigationButtons;\n\n      const otherWidth =\n        containerWidth -\n        (controlsRef.current?.offsetWidth ?? 0) -\n        (addButtonRef.current?.offsetWidth ?? 0) -\n        fixedWidth;\n\n      const itemSize = `${\n        otherWidth\n          ? Math.min(otherWidth / otherTabs.length, MAX_TAB_SIZE)\n          : MAX_TAB_SIZE\n      }px`;\n      setSizes(Array.from<string>({ length: otherTabs.length }).fill(itemSize));\n      setShowControls(showControls);\n    });\n\n    for (const ref of refs) {\n      ref.current && resizeObserver.observe(ref.current);\n    }\n\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [\n    otherTabs.length,\n    fixedTabs.length,\n    withNavigationButtons,\n    wrapperRef.current,\n    containerRef.current,\n    fixedTabsRef.current,\n    controlsRef.current,\n  ]);\n\n  return {\n    refs,\n    containerRef,\n    wrapperRef,\n    fixedTabsRef,\n    otherTabsRef,\n    showControls,\n    fixedTabs,\n    otherTabs,\n    navigate,\n    sizes,\n    controlsRef,\n    addButtonRef,\n  };\n};\n"],"mappings":"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"}