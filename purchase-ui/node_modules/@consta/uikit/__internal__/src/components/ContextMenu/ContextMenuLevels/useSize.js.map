{"version":3,"file":"useSize.js","names":["useEffect","useLayoutEffect","getElementSize","useMutableRef","useSize","refs","setFn","isActive","setRef","newState","oldState","height","width","elementRef","length","current","element","resizeObserver","ResizeObserver","res","target","observe","disconnect"],"sources":["../../../../../../src/components/ContextMenu/ContextMenuLevels/useSize.ts"],"sourcesContent":["import { useEffect, useLayoutEffect } from 'react';\n\nimport { ComponentSize, getElementSize } from '##/hooks/useComponentSize';\nimport { useMutableRef } from '##/hooks/useMutableRef';\n\nexport const useSize = (\n  refs: React.RefObject<HTMLDivElement>[],\n  setFn: React.Dispatch<React.SetStateAction<ComponentSize>>,\n  isActive?: boolean,\n) => {\n  const setRef = useMutableRef((newState: ComponentSize) => {\n    if (!isActive) {\n      return;\n    }\n\n    setFn((oldState) => {\n      if (\n        newState.height &&\n        newState.width &&\n        (oldState.height !== newState.height ||\n          oldState.width !== newState.width)\n      ) {\n        return newState;\n      }\n      return oldState;\n    });\n  });\n\n  const elementRef = refs?.[refs.length - 1];\n\n  useLayoutEffect(() => {\n    setRef.current(getElementSize(elementRef?.current));\n  }, [elementRef]);\n\n  useEffect(() => {\n    const element = elementRef?.current;\n\n    const resizeObserver = new ResizeObserver((res) => {\n      setRef.current(getElementSize(res[0].target as HTMLElement));\n    });\n\n    element && resizeObserver.observe(element);\n\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [elementRef]);\n};\n"],"mappings":"AAAA,OAASA,SAAT,CAAoBC,eAApB,KAA2C,OAA3C,CAEA,OAAwBC,cAAxB,uCACA,OAASC,aAAT,oCAEA,MAAO,IAAMC,QAAO,CAAG,SACrBC,CADqB,CAErBC,CAFqB,CAGrBC,CAHqB,CAIlB,IACGC,EAAM,CAAGL,aAAa,CAAC,SAACM,CAAD,CAA6B,CACnDF,CADmD,EAKxDD,CAAK,CAAC,SAACI,CAAD,CAAc,OAEhBD,EAAQ,CAACE,MAAT,EACAF,CAAQ,CAACG,KADT,GAECF,CAAQ,CAACC,MAAT,GAAoBF,CAAQ,CAACE,MAA7B,EACCD,CAAQ,CAACE,KAAT,GAAmBH,CAAQ,CAACG,KAH9B,CAFgB,CAOTH,CAPS,CASXC,CACR,CAVI,CAWN,CAhB2B,CADzB,CAmBGG,CAAU,QAAGR,CAAH,WAAGA,CAAH,QAAGA,CAAI,CAAGA,CAAI,CAACS,MAAL,CAAc,CAAjB,CAnBpB,CAqBHb,eAAe,CAAC,UAAM,CACpBO,CAAM,CAACO,OAAP,CAAeb,cAAc,QAACW,CAAD,WAACA,CAAD,QAACA,CAAU,CAAEE,OAAb,CAA7B,CACD,CAFc,CAEZ,CAACF,CAAD,CAFY,CArBZ,CAyBHb,SAAS,CAAC,UAAM,IACRgB,EAAO,QAAGH,CAAH,WAAGA,CAAH,QAAGA,CAAU,CAAEE,OADd,CAGRE,CAAc,CAAG,GAAIC,eAAJ,CAAmB,SAACC,CAAD,CAAS,CACjDX,CAAM,CAACO,OAAP,CAAeb,cAAc,CAACiB,CAAG,CAAC,CAAD,CAAH,CAAOC,MAAR,CAA7B,CACD,CAFsB,CAHT,CASd,MAFAJ,EAAO,EAAIC,CAAc,CAACI,OAAf,CAAuBL,CAAvB,CAEX,CAAO,UAAM,CACXC,CAAc,CAACK,UAAf,EACD,CACF,CAZQ,CAYN,CAACT,CAAD,CAZM,CAaV,CA1CM"}