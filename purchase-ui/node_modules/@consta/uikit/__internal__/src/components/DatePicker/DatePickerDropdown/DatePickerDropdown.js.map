{"version":3,"file":"DatePickerDropdown.js","names":["React","forwardRef","useCallback","useRef","useState","Transition","DateTime","Popover","useFlag","useForkRef","animateTimeout","cnMixPopoverAnimate","cn","DatePickerAdditionalControls","datePickerPropDropdownFormDefault","moveMap","cnDatePickerDropdown","DatePickerDropdown","props","componentRef","form","anchorRef","isOpen","className","zIndex","renderAdditionalControls","otherProps","rootRef","direction","setDirection","visibleAdditionalControls","setVisibleAdditionalControls","onMove","to","type","on","off","ref","animate","currentVisibleDate","view"],"sources":["../../../../../../src/components/DatePicker/DatePickerDropdown/DatePickerDropdown.tsx"],"sourcesContent":["import './DatePickerDropdown.css';\n\nimport React, { forwardRef, useCallback, useRef, useState } from 'react';\nimport { Transition } from 'react-transition-group';\n\nimport {\n  DateTime,\n  DateTimePropOnChange,\n  DateTimePropType,\n  MoveType,\n} from '##/components/DateTime';\nimport { Direction, Popover } from '##/components/Popover';\nimport { useFlag } from '##/hooks/useFlag';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { animateTimeout, cnMixPopoverAnimate } from '##/mixs/MixPopoverAnimate';\nimport { cn } from '##/utils/bem';\nimport { DateRange } from '##/utils/types/Date';\nimport { PropsWithHTMLAttributesAndRef } from '##/utils/types/PropsWithHTMLAttributes';\n\nimport { DatePickerAdditionalControls } from '../DatePickerAdditionalControls/DatePickerAdditionalControls';\nimport {\n  DatePickerAdditionalControlRenderProp,\n  DatePickerPropDateTimeView,\n  DatePickerPropDropdownForm,\n  datePickerPropDropdownFormDefault,\n} from '../types';\n\nexport type DatePickerDropdownPropOnChange = DateTimePropOnChange;\n\nexport type DatePickerDropdownProps = PropsWithHTMLAttributesAndRef<\n  {\n    anchorRef: React.RefObject<HTMLElement>;\n    currentVisibleDate?: Date;\n    type: DateTimePropType;\n    value?: Date | DateRange;\n    onChange?: DatePickerDropdownPropOnChange;\n    minDate?: Date;\n    maxDate?: Date;\n    events?: Date[];\n    view: DatePickerPropDateTimeView;\n    locale?: Locale;\n    children?: never;\n    form?: DatePickerPropDropdownForm;\n    isOpen?: boolean;\n    onChangeCurrentVisibleDate?: (date: Date) => void;\n    zIndex?: number;\n    renderAdditionalControls?: DatePickerAdditionalControlRenderProp;\n    multiplicitySeconds?: number;\n    multiplicityMinutes?: number;\n    multiplicityHours?: number;\n    timeFor?: 'start' | 'end';\n  },\n  HTMLDivElement\n>;\n\ntype DatePickerDropdownComponent = (\n  props: DatePickerDropdownProps,\n) => React.ReactElement | null;\n\nconst moveMap: Record<DateTimePropType, MoveType> = {\n  'year': 'year',\n  'month': 'month',\n  'date': 'day',\n  'time': 'time',\n  'date-time': 'day',\n};\n\nconst cnDatePickerDropdown = cn('DatePickerDropdown');\n\nexport const DatePickerDropdown: DatePickerDropdownComponent = forwardRef(\n  (props, componentRef) => {\n    const {\n      form = datePickerPropDropdownFormDefault,\n      anchorRef,\n      isOpen,\n      className,\n      zIndex,\n      renderAdditionalControls,\n      ...otherProps\n    } = props;\n\n    const rootRef = useRef<HTMLDivElement>(null);\n    const [direction, setDirection] = useState<Direction>();\n\n    const [visibleAdditionalControls, setVisibleAdditionalControls] =\n      useFlag(true);\n\n    const onMove = useCallback(\n      (to: MoveType) => {\n        to === moveMap[props.type]\n          ? setVisibleAdditionalControls.on()\n          : setVisibleAdditionalControls.off();\n      },\n      [props.type],\n    );\n\n    const ref = useForkRef([componentRef, rootRef]);\n\n    return (\n      <Transition\n        in={isOpen}\n        unmountOnExit\n        timeout={animateTimeout}\n        nodeRef={rootRef}\n      >\n        {(animate) => {\n          return (\n            <Popover\n              ref={ref}\n              anchorRef={anchorRef}\n              className={cnDatePickerDropdown({ form }, [\n                className,\n                cnMixPopoverAnimate({ direction, animate }),\n              ])}\n              direction=\"downStartLeft\"\n              spareDirection=\"downStartLeft\"\n              possibleDirections={[\n                'downStartLeft',\n                'upStartLeft',\n                'downStartRight',\n                'upStartRight',\n              ]}\n              style={{ zIndex }}\n              role=\"listbox\"\n              onSetDirection={setDirection}\n            >\n              <DateTime {...otherProps} onMove={onMove} />\n              {visibleAdditionalControls && (\n                <DatePickerAdditionalControls\n                  currentVisibleDate={props.currentVisibleDate}\n                  renderAdditionalControls={renderAdditionalControls}\n                  type={props.type}\n                  view={props.view}\n                />\n              )}\n            </Popover>\n          );\n        }}\n      </Transition>\n    );\n  },\n);\n"],"mappings":"kPAAA,iCAEA,MAAOA,MAAP,EAAgBC,UAAhB,CAA4BC,WAA5B,CAAyCC,MAAzC,CAAiDC,QAAjD,KAAiE,OAAjE,CACA,OAASC,UAAT,KAA2B,wBAA3B,CAEA,OACEC,QADF,sBAMA,OAAoBC,OAApB,qBACA,OAASC,OAAT,8BACA,OAASC,UAAT,iCACA,OAASC,cAAT,CAAyBC,mBAAzB,uCACA,OAASC,EAAT,0BAIA,OAASC,4BAAT,oEACA,OAIEC,iCAJF,gB,GAuCMC,QAA2C,CAAG,CAClD,KAAQ,MAD0C,CAElD,MAAS,OAFyC,CAGlD,KAAQ,KAH0C,CAIlD,KAAQ,MAJ0C,CAKlD,YAAa,KALqC,C,CAQ9CC,oBAAoB,CAAGJ,EAAE,CAAC,oBAAD,C,CAE/B,MAAO,IAAMK,mBAA+C,CAAGhB,UAAU,CACvE,SAACiB,CAAD,CAAQC,CAAR,CAAyB,OASnBD,CATmB,CAErBE,IAFqB,CAErBA,CAFqB,YAEdN,iCAFc,GAGrBO,CAHqB,CASnBH,CATmB,CAGrBG,SAHqB,CAIrBC,CAJqB,CASnBJ,CATmB,CAIrBI,MAJqB,CAKrBC,CALqB,CASnBL,CATmB,CAKrBK,SALqB,CAMrBC,CANqB,CASnBN,CATmB,CAMrBM,MANqB,CAOrBC,CAPqB,CASnBP,CATmB,CAOrBO,wBAPqB,CAQlBC,CARkB,0BASnBR,CATmB,YAWjBS,CAAO,CAAGxB,MAAM,CAAiB,IAAjB,CAXC,GAYWC,QAAQ,EAZnB,uBAYhBwB,CAZgB,MAYLC,CAZK,QAerBrB,OAAO,IAfc,uBAchBsB,CAdgB,MAcWC,CAdX,MAiBjBC,CAAM,CAAG9B,WAAW,CACxB,SAAC+B,CAAD,CAAkB,CAChBA,CAAE,GAAKlB,OAAO,CAACG,CAAK,CAACgB,IAAP,CAAd,CACIH,CAA4B,CAACI,EAA7B,EADJ,CAEIJ,CAA4B,CAACK,GAA7B,EACL,CALuB,CAMxB,CAAClB,CAAK,CAACgB,IAAP,CANwB,CAjBH,CA0BjBG,CAAG,CAAG5B,UAAU,CAAC,CAACU,CAAD,CAAeQ,CAAf,CAAD,CA1BC,CA4BvB,MACE,qBAAC,UAAD,EACE,GAAIL,CADN,CAEE,aAAa,GAFf,CAGE,OAAO,CAAEZ,cAHX,CAIE,OAAO,CAAEiB,CAJX,EAMG,SAACW,CAAD,CAAa,CACZ,MACE,qBAAC,OAAD,EACE,GAAG,CAAED,CADP,CAEE,SAAS,CAAEhB,CAFb,CAGE,SAAS,CAAEL,oBAAoB,CAAC,CAAEI,IAAI,CAAJA,CAAF,CAAD,CAAW,CACxCG,CADwC,CAExCZ,mBAAmB,CAAC,CAAEiB,SAAS,CAATA,CAAF,CAAaU,OAAO,CAAPA,CAAb,CAAD,CAFqB,CAAX,CAHjC,CAOE,SAAS,CAAC,eAPZ,CAQE,cAAc,CAAC,eARjB,CASE,kBAAkB,CAAE,CAClB,eADkB,CAElB,aAFkB,CAGlB,gBAHkB,CAIlB,cAJkB,CATtB,CAeE,KAAK,CAAE,CAAEd,MAAM,CAANA,CAAF,CAfT,CAgBE,IAAI,CAAC,SAhBP,CAiBE,cAAc,CAAEK,CAjBlB,EAmBE,oBAAC,QAAD,kBAAcH,CAAd,EAA0B,MAAM,CAAEM,CAAlC,GAnBF,CAoBGF,CAAyB,EACxB,oBAAC,4BAAD,EACE,kBAAkB,CAAEZ,CAAK,CAACqB,kBAD5B,CAEE,wBAAwB,CAAEd,CAF5B,CAGE,IAAI,CAAEP,CAAK,CAACgB,IAHd,CAIE,IAAI,CAAEhB,CAAK,CAACsB,IAJd,EArBJ,CA8BH,CAtCH,CAyCH,CAvEsE,CAAlE"}