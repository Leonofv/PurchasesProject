{"version":3,"file":"DatePickerTypeMonth.js","names":["addYears","startOfYear","React","forwardRef","useEffect","useRef","useClickOutside","useForkRef","setRef","DatePickerDropdown","DatePickerFieldTypeMonth","getDropdownZIndex","datePickerPropDateTimeViewDefault","useCalendarVisible","useCurrentVisibleDate","DatePickerTypeMonth","props","ref","events","dateTimeView","locale","dropdownForm","dropdownClassName","currentVisibleDateProp","currentVisibleDate","onChangeCurrentVisibleDate","renderAdditionalControls","onDropdownOpen","dropdownOpen","ignoreOutsideClicksRefs","disabled","inputRefProp","inputRef","otherProps","fieldRef","calendarRef","startRef","calendarVisible","setCalendarVisible","maxDate","minDate","value","startOfUnit","setCurrentVisibleDate","current","newVisibleDate","getTime","isActive","ignoreClicksInsideRefs","handler","off","on","args","onChange","style"],"sources":["../../../../../../src/components/DatePicker/DatePickerTypeMonth/DatePickerTypeMonth.tsx"],"sourcesContent":["import addYears from 'date-fns/addYears';\nimport startOfYear from 'date-fns/startOfYear';\nimport React, { forwardRef, useEffect, useRef } from 'react';\n\nimport { useClickOutside } from '##/hooks/useClickOutside/useClickOutside';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { setRef } from '##/utils/setRef';\n\nimport { DatePickerDropdown } from '../DatePickerDropdown/DatePickerDropdown';\nimport { DatePickerFieldTypeMonth } from '../DatePickerFieldTypeMonth/DatePickerFieldTypeMonth';\nimport { getDropdownZIndex } from '../helpers';\nimport {\n  datePickerPropDateTimeViewDefault,\n  DatePickerTypeComponent,\n} from '../types';\nimport { useCalendarVisible } from '../useCalendarVisible';\nimport { useCurrentVisibleDate } from '../useCurrentVisibleDate';\n\nexport const DatePickerTypeMonth: DatePickerTypeComponent<'month'> = forwardRef(\n  (props, ref) => {\n    const {\n      events,\n      dateTimeView = datePickerPropDateTimeViewDefault,\n      locale,\n      dropdownForm,\n      dropdownClassName,\n      currentVisibleDate: currentVisibleDateProp,\n      onChangeCurrentVisibleDate,\n      renderAdditionalControls,\n      onDropdownOpen,\n      dropdownOpen,\n      ignoreOutsideClicksRefs,\n      disabled,\n      inputRef: inputRefProp,\n      ...otherProps\n    } = props;\n\n    const fieldRef = useRef<HTMLDivElement>(null);\n    const calendarRef = useRef<HTMLDivElement>(null);\n    const inputRef = useRef<HTMLInputElement>(null);\n\n    const [calendarVisible, setCalendarVisible] = useCalendarVisible({\n      dropdownOpen,\n      onDropdownOpen,\n      disabled,\n      startRef: inputRef,\n    });\n\n    const [currentVisibleDate, setCurrentVisibleDate] = useCurrentVisibleDate({\n      currentVisibleDate: currentVisibleDateProp,\n      maxDate: props.maxDate,\n      minDate: props.minDate,\n      value: props.value,\n      startOfUnit: startOfYear,\n      onChangeCurrentVisibleDate,\n      calendarVisible,\n    });\n\n    useEffect(() => {\n      if (ref) {\n        setRef(ref, fieldRef.current);\n      }\n    }, [ref, fieldRef]);\n\n    useEffect(() => {\n      if (props.value && dateTimeView === 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfYear(props.value);\n        if (newVisibleDate.getTime() !== currentVisibleDate.getTime()) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n        return;\n      }\n      if (props.value && dateTimeView !== 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfYear(props.value);\n        if (\n          newVisibleDate.getTime() !== currentVisibleDate.getTime() &&\n          newVisibleDate.getTime() !== addYears(currentVisibleDate, 1).getTime()\n        ) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n      }\n    }, [props.value]);\n\n    useClickOutside({\n      isActive: calendarVisible,\n      ignoreClicksInsideRefs: [\n        fieldRef,\n        calendarRef,\n        ...(ignoreOutsideClicksRefs ?? []),\n      ],\n      handler: setCalendarVisible.off,\n    });\n\n    return (\n      <>\n        <DatePickerFieldTypeMonth\n          {...otherProps}\n          ref={fieldRef}\n          inputRef={useForkRef([inputRef, inputRefProp])}\n          onClick={setCalendarVisible.on}\n          disabled={disabled}\n        />\n        <DatePickerDropdown\n          ref={calendarRef}\n          anchorRef={fieldRef}\n          isOpen={calendarVisible}\n          value={props.value || undefined}\n          type=\"month\"\n          view={dateTimeView}\n          events={events}\n          locale={locale}\n          minDate={props.minDate}\n          className={dropdownClassName}\n          maxDate={props.maxDate}\n          currentVisibleDate={currentVisibleDate}\n          form={dropdownForm}\n          onChange={(...args) => {\n            props.onChange?.(...args);\n            setCalendarVisible.off();\n          }}\n          renderAdditionalControls={renderAdditionalControls}\n          onChangeCurrentVisibleDate={setCurrentVisibleDate}\n          zIndex={getDropdownZIndex(props.style)}\n        />\n      </>\n    );\n  },\n);\n"],"mappings":"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"}