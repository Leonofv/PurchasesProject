{"version":3,"file":"useOnChange.js","names":["getHours","getMinutes","getSeconds","set","useCallback","useEffect","useState","useMutableRef","getTime","date","useOnChange","onChange","onChangeRange","value","timeFor","normalizeValue","Array","isArray","time","setTime","onChangeRef","onChangeRangeRef","timeRef","onDateChange","e","current","hours","minutes","seconds","newValue","onDateChangeRange","onTimeChange"],"sources":["../../../../../../src/components/DateTime/DateTimeTypeDateTime/useOnChange.ts"],"sourcesContent":["import { getHours, getMinutes, getSeconds, set } from 'date-fns';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport { useMutableRef } from '../../../hooks/useMutableRef/useMutableRef';\nimport { DateRange } from '../../../utils/types/Date';\nimport { DateTimePropOnChange, DateTimePropOnChangeRange } from '../helpers';\n\nconst getTime = (date?: Date) => {\n  if (!date) {\n    return [0, 0, 0] as const;\n  }\n  return [getHours(date), getMinutes(date), getSeconds(date)] as const;\n};\n\nexport const useOnChange = (\n  onChange: DateTimePropOnChange | undefined,\n  onChangeRange: DateTimePropOnChangeRange<'date-time'> | undefined,\n  value: DateRange | Date | undefined,\n  timeFor: 'start' | 'end',\n): [\n  DateTimePropOnChange,\n  DateTimePropOnChangeRange<'date-time'>,\n  DateTimePropOnChange,\n  Date | undefined,\n] => {\n  const normalizeValue = Array.isArray(value)\n    ? value[timeFor === 'start' ? 0 : 1]\n    : value;\n\n  const [time, setTime] = useState<Date | undefined>(normalizeValue);\n\n  const onChangeRef = useMutableRef(onChange);\n  const onChangeRangeRef = useMutableRef(onChangeRange);\n  const timeRef = useMutableRef(time);\n\n  const onDateChange: DateTimePropOnChange = useCallback((value, { e }) => {\n    const [hours, minutes, seconds] = getTime(timeRef.current);\n    const newValue = set(value, { hours, minutes, seconds });\n    onChangeRef.current?.(newValue, {\n      e,\n    });\n  }, []);\n\n  const onDateChangeRange: DateTimePropOnChangeRange<'date-time'> = useCallback(\n    (value, { e }) => {\n      const [hours, minutes, seconds] = getTime(timeRef.current);\n      const newValue: DateRange = [\n        value[0] ? set(value[0], { hours, minutes, seconds }) : undefined,\n        value[1] ? set(value[1], { hours, minutes, seconds }) : undefined,\n      ];\n      onChangeRangeRef.current?.(newValue, {\n        e,\n      });\n    },\n    [],\n  );\n\n  const onTimeChange: DateTimePropOnChange = useCallback((value, { e }) => {\n    onChangeRef.current?.(value, { e });\n  }, []);\n\n  useEffect(() => setTime(normalizeValue), [normalizeValue?.getTime()]);\n\n  return [onDateChange, onDateChangeRange, onTimeChange, normalizeValue];\n};\n"],"mappings":"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"}