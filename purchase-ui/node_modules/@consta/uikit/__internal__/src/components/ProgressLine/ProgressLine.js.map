{"version":3,"file":"ProgressLine.js","names":["React","forwardRef","useMemo","useRef","useComponentSize","useForkRef","cn","isNotNil","Text","calculateLinePositions","generateMask","getProgress","withDefaultGetters","cnProgressLine","ProgressLineRender","props","ref","size","value","style","className","steps","getItemLabel","otherProps","containerRef","containerWidth","width","lines","length","mask","data","mode","activeIndex","Math","min","containerProps","x","map","item","index","label","ProgressLine"],"sources":["../../../../../src/components/ProgressLine/ProgressLine.tsx"],"sourcesContent":["import './ProgressLine.css';\n\nimport React, { forwardRef, useMemo, useRef } from 'react';\n\nimport { useComponentSize } from '##/hooks/useComponentSize';\nimport { useForkRef } from '##/hooks/useForkRef';\n\nimport { cn } from '../../utils/bem';\nimport { isNotNil } from '../../utils/type-guards';\nimport { Text } from '../Text/Text';\nimport {\n  calculateLinePositions,\n  generateMask,\n  getProgress,\n  withDefaultGetters,\n} from './helpers';\nimport { ProgressLineComponent, ProgressLineProps } from './types';\n\nconst cnProgressLine = cn('ProgressLine');\n\nconst ProgressLineRender = (\n  props: ProgressLineProps,\n  ref: React.Ref<HTMLDivElement>,\n) => {\n  const {\n    size = 'm',\n    value,\n    style,\n    className,\n    steps,\n    getItemLabel,\n    ...otherProps\n  } = withDefaultGetters(props);\n\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const { width: containerWidth } = useComponentSize(containerRef);\n\n  const [lines, mask] = useMemo(() => {\n    const lines = calculateLinePositions(steps?.length ?? 0, containerWidth);\n\n    return [lines, generateMask(lines)];\n  }, [containerWidth, steps]);\n\n  const { mode, activeIndex } = useMemo(() => {\n    const data = {\n      mode: isNotNil(value) ? 'determinate' : 'indeterminate',\n      activeIndex: isNotNil(value) ? Math.min(value, steps?.length ?? 0) : -1,\n    };\n    if (steps) {\n      data.mode = 'step';\n      if ((value ?? 0) >= steps.length) {\n        data.activeIndex = steps.length - 1;\n      }\n    }\n    return data;\n  }, [steps, value]);\n\n  const containerProps = {\n    ...otherProps,\n    ref: useForkRef([ref, containerRef]),\n    className: cnProgressLine(\n      {\n        size,\n        mode,\n      },\n      [className],\n    ),\n    style: {\n      ...style,\n      ['--progress-line-value' as string]: `${getProgress(value ?? 0)}`,\n      ['--progress-line-steps' as string]: steps?.length,\n      ['--progress-line-background-active-width' as string]: `${\n        lines?.[activeIndex]\n          ? lines[activeIndex].x + lines[activeIndex].width\n          : 0\n      }px`,\n      ['--progress-line-mask' as string]: mask,\n    },\n  };\n\n  return (\n    <div {...containerProps}>\n      {steps && (\n        <div className={cnProgressLine('Steps')}>\n          {steps?.map((item, index) => {\n            const label = getItemLabel(item);\n            return (\n              <div\n                key={cnProgressLine('Step', { index })}\n                className={cnProgressLine('Step')}\n              >\n                {isNotNil(label) && (\n                  <Text\n                    className={cnProgressLine('Label')}\n                    size=\"2xs\"\n                    lineHeight=\"xs\"\n                    view=\"secondary\"\n                    align=\"center\"\n                  >\n                    {label}\n                  </Text>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport const ProgressLine = forwardRef(\n  ProgressLineRender,\n) as ProgressLineComponent;\n"],"mappings":"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"}