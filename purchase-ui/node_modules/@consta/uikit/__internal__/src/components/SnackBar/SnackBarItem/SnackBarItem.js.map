{"version":3,"file":"SnackBarItem.js","names":["IconClose","React","useEffect","useState","useFlag","cn","isNumber","isString","Button","Text","cnTheme","SnackBarActionButton","SnackBarLine","SnackBarTimer","snackBarItemStatusDefault","snackBarPropFormDefault","defaultInitialTimerTime","cnSnackBarItem","getAutoCloseTime","autoClose","SnackBarItemRender","props","ref","onClose","showProgress","Icon","icon","form","message","actions","status","onAutoCloseProp","onAutoClose","className","otherProps","timerFunctions","setTimerFunctions","hover","onHover","on","offHover","off","timeIsOver","onTimeIsOver","handleMountTimer","autoCloseTime","hideAutoCloseTimer","pause","start","handleTimeIsOver","handleClose","color","handleMouseEnter","handleMouseLeave","SnackBarItem","forwardRef"],"sources":["../../../../../../src/components/SnackBar/SnackBarItem/SnackBarItem.tsx"],"sourcesContent":["import '../../Theme/_color/Theme_color_gpnDark.css';\nimport './SnackBarItem.css';\n\nimport { IconClose } from '@consta/icons/IconClose';\nimport React, { useEffect, useState } from 'react';\n\nimport { useFlag } from '../../../hooks/useFlag/useFlag';\nimport { cn } from '../../../utils/bem';\nimport { isNumber, isString } from '../../../utils/type-guards';\nimport { Button } from '../../Button/Button';\nimport { Text } from '../../Text/Text';\nimport { cnTheme } from '../../Theme/Theme';\nimport { SnackBarActionButton } from '../SnackBarActionButton/SnackBarActionButton';\nimport { SnackBarLine } from '../SnackBarLine/SnackBarLine';\nimport { SnackBarTimer } from '../SnackBarTimer/SnackBarTimer';\nimport {\n  SnackBarItemComponent,\n  SnackBarItemProps,\n  snackBarItemStatusDefault,\n  snackBarPropFormDefault,\n  SnackBarTimerPropOnMount,\n} from '../types';\n\nconst defaultInitialTimerTime = 3;\n\nexport const cnSnackBarItem = cn('SnackBarItem');\n\nconst getAutoCloseTime = (\n  autoClose: boolean | number | undefined,\n): number | false => {\n  if (autoClose) {\n    if (typeof autoClose === 'number') {\n      return autoClose;\n    }\n    return defaultInitialTimerTime;\n  }\n  return false;\n};\n\nexport const SnackBarItemRender = (\n  props: SnackBarItemProps,\n  ref: React.Ref<HTMLDivElement>,\n) => {\n  const {\n    onClose,\n    autoClose,\n    showProgress,\n    icon: Icon,\n    form = snackBarPropFormDefault,\n    message,\n    actions,\n    status = snackBarItemStatusDefault,\n    onAutoClose: onAutoCloseProp,\n    className,\n    ...otherProps\n  } = props;\n\n  const [timerFunctions, setTimerFunctions] = useState<{\n    start: () => void;\n    pause: () => void;\n  } | null>(null);\n  const [hover, { on: onHover, off: offHover }] = useFlag(false);\n  const [timeIsOver, { on: onTimeIsOver }] = useFlag(false);\n  const handleMountTimer: SnackBarTimerPropOnMount = (timerFunctions) =>\n    setTimerFunctions(timerFunctions);\n  const handleMouseEnter = () => onHover();\n  const handleMouseLeave = () => offHover();\n  const autoCloseTime = getAutoCloseTime(autoClose);\n  const hideAutoCloseTimer =\n    showProgress === undefined ||\n    !(isNumber(autoCloseTime) && autoCloseTime > 0);\n  const onAutoClose = () => {\n    if (onAutoCloseProp) {\n      onAutoCloseProp();\n    } else {\n      onClose?.();\n    }\n  };\n\n  useEffect(() => {\n    if (!timeIsOver) {\n      if (hover) {\n        timerFunctions && timerFunctions.pause();\n      } else {\n        timerFunctions && timerFunctions.start();\n      }\n    }\n  }, [hover, timeIsOver, timerFunctions]);\n\n  const handleTimeIsOver = () => {\n    onTimeIsOver();\n    onAutoClose();\n  };\n\n  const handleClose = onClose ? () => onClose() : undefined;\n\n  return (\n    <div\n      ref={ref}\n      className={cnSnackBarItem({ status, showProgress, form }, [\n        cnTheme({ color: 'gpnDark' }),\n        className,\n      ])}\n      onMouseEnter={autoCloseTime ? handleMouseEnter : undefined}\n      onMouseLeave={autoCloseTime ? handleMouseLeave : undefined}\n      {...otherProps}\n    >\n      {autoCloseTime && showProgress !== 'line' && (\n        <SnackBarTimer\n          className={cnSnackBarItem('Timer')}\n          onMount={handleMountTimer}\n          onTimeIsOver={handleTimeIsOver}\n          startTime={autoCloseTime}\n          hidden={hideAutoCloseTimer}\n        />\n      )}\n      {Icon &&\n        ((hideAutoCloseTimer && showProgress === 'timer') ||\n          showProgress !== 'timer') && (\n          <Icon className={cnSnackBarItem('Icon')} size=\"m\" />\n        )}\n      <div className={cnSnackBarItem('Content')}>\n        {isString(message) || isNumber(message) ? (\n          <Text\n            view=\"primary\"\n            size=\"m\"\n            className={cnSnackBarItem('Message')}\n            lineHeight=\"s\"\n          >\n            {message}\n          </Text>\n        ) : (\n          message\n        )}\n        {actions && (\n          <SnackBarActionButton\n            actions={actions}\n            className={cnSnackBarItem('ActionButton')}\n          />\n        )}\n      </div>\n      {onClose && (\n        <Button\n          className={cnSnackBarItem('CloseButton')}\n          view=\"clear\"\n          iconLeft={IconClose}\n          form=\"round\"\n          type=\"button\"\n          size=\"xs\"\n          onClick={handleClose}\n        />\n      )}\n      {autoCloseTime && showProgress === 'line' && (\n        <SnackBarLine\n          className={cnSnackBarItem('Line')}\n          onMount={handleMountTimer}\n          onTimeIsOver={handleTimeIsOver}\n          startTime={autoCloseTime}\n        />\n      )}\n    </div>\n  );\n};\n\nexport const SnackBarItem = React.forwardRef(\n  SnackBarItemRender,\n) as SnackBarItemComponent;\n"],"mappings":"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"}