import _toConsumableArray from"@babel/runtime/helpers/toConsumableArray";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import _defineProperty from"@babel/runtime/helpers/defineProperty";function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}import React from"react";import{isNotNil,isNumber,isString}from"../../utils/type-guards";export var Order={ASC:"ASC",asc:"asc",DESC:"DESC",desc:"desc"};export var getColumnsSize=function(a){return a.map(function(a){return isNumber(a)?"".concat(a,"px"):"auto"}).join(" ")};export var getColumnLeftOffset=function(a){var b=a.columnIndex,c=a.resizedColumnWidths,d=a.initialColumnWidths,e=d.slice(0,b).map(function(a,b){return c[b]||a});return e.reduce(function(a,b){return a+b},0)};export var createSortingState=function(a,b,c){return isString(b)?{by:a,order:b.toLowerCase(),sortFn:c}:null};export var getNewSorting=function(a,b,c){return a&&a.by===b?"asc"===a.order?{by:b,order:"desc",sortFn:c}:null:{by:b,order:"asc",sortFn:c}};export var getMaxLevel=function(a){var b=0,c=function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;d>b&&(b=d),a.forEach(function(a){a.columns&&c(a.columns,d+1)})};return c(a),b};var getLastChildrenCount=function(a){var b=0,c=function(a){a.forEach(function(a){a.columns?c(a.columns):b++})};return c(a),b};export var transformColumns=function(a,b){for(var c=[{columns:a,index:0}],d=[],e=0;c.length;){var f=c.length-1,g=c[f],h=g.columns[g.index];h?function(a){d[f]||(d[f]=[]);var i=c[0].index,j=d[f][d[f].length-1],k=j?j.position.gridIndex+(j.position.colSpan||1):0,l=0===f?e++:null!==(a=h.colId)&&void 0!==a?a:0,m=_objectSpread(_objectSpread({},h),{},{position:{topHeaderGridIndex:i,gridIndex:k,level:f}});0===f&&(m.colId=l),m.columns?(m.position.colSpan=getLastChildrenCount(m.columns),d[f].push(m),c.push({columns:m.columns.map(function(a){return _objectSpread(_objectSpread({},a),{},{colId:e++,parentId:l})}),index:0})):(m.position.rowSpan=b-f,d[f].push(m),g.index++)}():(c.pop(),c[c.length-1]&&c[c.length-1].index++)}return d};var getIsFirst=function(a,b){var c,d,e=b.colId,f=b.parentId,g=b.position,h=b.accessor;if(0===g.level)return 0===e;var i=a.find(function(a){return a.colId===f});return!!((null===i||void 0===i||null===(c=i.columns)||void 0===c||null===(d=c[0])||void 0===d?void 0:d.accessor)===h&&!!i&&getIsFirst(a,i))};export var useHeaderData=function(a){var b=React.useRef({}),c=transformColumns(a,getMaxLevel(a)),d=Object.values(b.current).filter(isNotNil).map(function(a){return a.getBoundingClientRect().height}),e=c.flat().filter(function(a){return!a.hidden}).map(function(a,b,e){return _objectSpread(_objectSpread({},a),{},{position:_objectSpread(_objectSpread({},a.position),{},{isFirst:getIsFirst(e,a),smallTextSize:1<c.length&&a.position.level===c.length-1,height:d[b]||0})})}),f=c.map(function(a,b){return Math.min.apply(null,e.filter(function(a){return a.position.level===b}).map(function(a){return a.position.height}))}),g=e.filter(function(a){var b=a.position.colSpan;return!b}).sort(function(c,a){return c.position.topHeaderGridIndex===a.position.topHeaderGridIndex?c.position.gridIndex>a.position.gridIndex?1:-1:c.position.topHeaderGridIndex>a.position.topHeaderGridIndex?1:-1}),h=g.map(function(a,b){var c,d,e=f.reduce(function(c,a){return c+a},0);return(a.position.rowSpan||0)>=((null===(c=g[b+1])||void 0===c?void 0:c.position.rowSpan)||0)?e-(a.position.height||0):e-(null===(d=g[b+1])||void 0===d?void 0:d.position.height)||0});return{headers:c,flattenedHeaders:e,lowHeaders:g,headerRowsRefs:b,headerRowsHeights:f,headerColumnsHeights:d,resizerTopOffsets:h}};export var useLazyLoadData=function(a,b,c){var d=React.useState(0),e=_slicedToArray(d,2),f=e[0],g=e[1],h=React.useRef(null),i=React.useRef(null),j=Math.floor(a/3);React.useEffect(function(){if(c){var a=0;b&&"offsetHeight"in b?a=b.offsetHeight:b&&"outerHeight"in b&&(a=b.outerHeight);var d=function(){i.current&&a/2>i.current.getBoundingClientRect().top?g(function(a){return a+j}):h.current&&h.current.getBoundingClientRect().top>a/2&&g(function(a){return 0>a-j?0:a-j})};return null===b||void 0===b?void 0:b.addEventListener("scroll",d),function(){return null===b||void 0===b?void 0:b.removeEventListener("scroll",d)}}},[f,b]);return{getSlicedRows:function getSlicedRows(b){return!c||b.length<a?b:b.slice(f,f+a)},setBoundaryRef:function setBoundaryRef(b,d){return c&&0===b&&d===j&&0<f?h:c&&0===b&&d===a-j?i:void 0}}};export var transformRows=function(a,b,c){for(var d=[{rows:a,index:0}],e=[];d.length;){var f=d.length-1,g=d[f],h=g.rows[g.index];if(h){var i=_objectSpread(_objectSpread({},h),{},{options:{level:f},rows:h.rows&&_toConsumableArray(h.rows)}),j=!!i.rows&&(c||b.includes(i.id));j?d.push({rows:i.rows,index:0}):g.index++,e.push(i)}else d.pop(),d[d.length-1]&&d[d.length-1].index++}return e};export function getMergedArray(a,b){for(var c=Math.max(a.length,b.length),d=[],e=0;e<c;e++){var f;d.push(null!==(f=b[e])&&void 0!==f?f:a[e])}return d}export function calulateColSpans(a,b){var c=[],d=0,e=a.length,f=function(a,b){return b+a>e?e-b-a:a};return a.forEach(function(a){var e=a.colSpan,g=1<c.length?c.reduce(function(c,a){return c+a}):0;if("number"==typeof e||"function"==typeof e){var h="number"==typeof e?e:e(b);0===d?c.push(f(h,g)):c.push(f(h-d||0,g)),d=0<h-d?h-1:d-h}else 0===d?c.push(f(1,g)):(c.push(0),d--)}),c}
//# sourceMappingURL=helpers.js.map