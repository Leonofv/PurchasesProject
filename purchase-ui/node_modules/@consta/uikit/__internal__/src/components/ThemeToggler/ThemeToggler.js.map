{"version":3,"file":"ThemeToggler.js","names":["IconCheck","React","forwardRef","useRef","Button","ContextMenu","usePropsHandler","useChoiceGroup","useFlag","useForkRef","contextMenuSizeMap","iconSizeMap","withDefaultGetters","themeTogglerPropSizeDefault","COMPONENT_NAME","ThemeTogglerRender","props","ref","anchorRef","buttonRef","size","items","value","onChange","getItemKey","getItemLabel","getItemIcon","direction","possibleDirections","style","view","otherProps","isOpen","setIsOpen","getKey","callBack","multiple","getOnChange","getChecked","iconSize","contextMenuSize","length","getButtonIcon","find","theme","onButtonClick","e","toggle","renderIcons","item","Icon","renderChecks","off","zIndex","ThemeToggler"],"sources":["../../../../../src/components/ThemeToggler/ThemeToggler.tsx"],"sourcesContent":["import { IconCheck } from '@consta/icons/IconCheck';\nimport React, { forwardRef, useRef } from 'react';\n\nimport { Button } from '##/components/Button';\nimport { ContextMenu } from '##/components/ContextMenu';\nimport { usePropsHandler } from '##/components/EventInterceptor/usePropsHandler';\nimport { useChoiceGroup } from '##/hooks/useChoiceGroup';\nimport { useFlag } from '##/hooks/useFlag';\nimport { useForkRef } from '##/hooks/useForkRef';\n\nimport { contextMenuSizeMap, iconSizeMap, withDefaultGetters } from './helpers';\nimport {\n  ThemeTogglerComponent,\n  ThemeTogglerProps,\n  themeTogglerPropSizeDefault,\n} from './types';\n\nexport const COMPONENT_NAME = 'ThemeToggler' as const;\n\nconst ThemeTogglerRender = (\n  props: ThemeTogglerProps,\n  ref: React.Ref<HTMLButtonElement>,\n) => {\n  const anchorRef = useRef<HTMLButtonElement>(null);\n  const buttonRef = useForkRef([anchorRef, ref]);\n\n  const {\n    size = themeTogglerPropSizeDefault,\n    items,\n    value,\n    onChange,\n    getItemKey,\n    getItemLabel,\n    getItemIcon,\n    direction,\n    possibleDirections,\n    style,\n    view = 'clear',\n    ...otherProps\n  } = usePropsHandler(COMPONENT_NAME, withDefaultGetters(props), buttonRef);\n\n  const [isOpen, setIsOpen] = useFlag(false);\n\n  const { getOnChange, getChecked } = useChoiceGroup({\n    value,\n    getKey: getItemKey || getItemLabel,\n    callBack: onChange,\n    multiple: false,\n  });\n\n  type Item = typeof items[number];\n\n  const iconSize = iconSizeMap[size];\n  const contextMenuSize = contextMenuSizeMap[size];\n\n  const getButtonIcon = () =>\n    getItemIcon(items.find((theme) => getChecked(theme)) ?? items[0]);\n\n  const onButtonClick = (e: React.MouseEvent<Element, MouseEvent>) => {\n    if (items.length > 2) {\n      setIsOpen.toggle();\n    } else {\n      getOnChange(items[getChecked(items[0]) ? 1 : 0])(e);\n    }\n  };\n\n  const renderIcons = (item: Item) => {\n    const Icon = getItemIcon(item);\n\n    if (Icon) {\n      return <Icon size={iconSize} />;\n    }\n  };\n\n  const renderChecks = (item: Item) => {\n    if (getChecked(item)) {\n      return <IconCheck size={iconSize} />;\n    }\n  };\n\n  if (items.length <= 1) {\n    return null;\n  }\n\n  return (\n    <>\n      <Button\n        {...otherProps}\n        ref={buttonRef}\n        iconLeft={getButtonIcon()}\n        onClick={onButtonClick}\n        onlyIcon\n        type=\"button\"\n        size={size}\n        view={view}\n        style={style}\n      />\n      {items.length > 2 && (\n        <ContextMenu\n          isOpen={isOpen}\n          offset=\"s\"\n          items={items}\n          getItemLabel={getItemLabel}\n          getItemKey={getItemKey || getItemLabel}\n          anchorRef={anchorRef}\n          direction={direction}\n          possibleDirections={possibleDirections}\n          getItemLeftSide={renderIcons}\n          getItemRightSide={renderChecks}\n          onClickOutside={setIsOpen.off}\n          onItemClick={(item, { e }) => getOnChange(item)(e)}\n          size={contextMenuSize}\n          style={\n            typeof style?.zIndex === 'number'\n              ? { zIndex: style.zIndex + 1 }\n              : undefined\n          }\n        />\n      )}\n    </>\n  );\n};\n\nexport const ThemeToggler = forwardRef(\n  ThemeTogglerRender,\n) as ThemeTogglerComponent;\n\nexport * from './types';\n"],"mappings":"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"}