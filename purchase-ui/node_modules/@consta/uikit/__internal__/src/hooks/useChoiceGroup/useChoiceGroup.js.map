{"version":3,"file":"useChoiceGroup.js","names":["isNotNil","isMultiple","params","multiple","isNotMultiple","formatValue","valueProp","getKey","valueByKey","Array","isArray","value","length","item","useChoiceGroup","props","formatedValue","getChecked","Object","prototype","hasOwnProperty","call","getOnChange","selectedItem","e","newValue","filter","push","callBack"],"sources":["../../../../../src/hooks/useChoiceGroup/useChoiceGroup.tsx"],"sourcesContent":["import { isNotNil } from '##/utils/type-guards';\n\ntype GetKey<ITEM> = (item: ITEM) => string | number;\n\ntype GetOnChange<ITEM, EVENT> = (item: ITEM) => (e: EVENT) => void;\n\ntype GetChecked<ITEM> = (item: ITEM) => boolean;\n\ntype UseChoiceGroupValues<ITEM, EVENT> = {\n  getOnChange: GetOnChange<ITEM, EVENT>;\n  getChecked: GetChecked<ITEM>;\n};\n\nexport type CallbackWithMultiple<ITEM, EVENT> = (\n  value: ITEM[] | null,\n  props: {\n    e: EVENT;\n  },\n) => void;\n\nexport type CallbackWithoutMultiple<ITEM, EVENT> = (\n  value: ITEM,\n  props: {\n    e: EVENT;\n  },\n) => void;\n\ntype PropsWithMultiple<ITEM, EVENT> = {\n  multiple: true;\n  value: ITEM[] | null;\n  callBack?: CallbackWithMultiple<ITEM, EVENT>;\n};\n\ntype PropsWithoutMultiple<ITEM, EVENT> = {\n  multiple: false;\n  value: ITEM | null;\n  callBack?: CallbackWithoutMultiple<ITEM, EVENT>;\n};\n\ntype CommonProps<ITEM> = {\n  getKey: GetKey<ITEM>;\n};\n\ntype UseChoiceGroupProps<ITEM, EVENT> = CommonProps<ITEM> &\n  (PropsWithMultiple<ITEM, EVENT> | PropsWithoutMultiple<ITEM, EVENT>);\n\ntype FormatedItems<ITEM> = { [value: string]: ITEM };\n\nfunction isMultiple<ITEM, EVENT>(\n  params: UseChoiceGroupProps<ITEM, EVENT>,\n): params is CommonProps<ITEM> & PropsWithMultiple<ITEM, EVENT> {\n  return params.multiple;\n}\n\nfunction isNotMultiple<ITEM, EVENT>(\n  params: UseChoiceGroupProps<ITEM, EVENT>,\n): params is CommonProps<ITEM> & PropsWithoutMultiple<ITEM, EVENT> {\n  return !params.multiple;\n}\n\nfunction formatValue<ITEM>(\n  valueProp: ITEM | ITEM[] | null,\n  getKey: GetKey<ITEM>,\n  multiple?: boolean,\n) {\n  const valueByKey: FormatedItems<ITEM> = {};\n  if (!isNotNil(valueProp) && !Array.isArray(valueProp)) {\n    return valueByKey;\n  }\n  const value = multiple ? (valueProp as ITEM[]) : [valueProp as ITEM];\n  if (value && value.length > 0) {\n    for (const item of value) {\n      valueByKey[getKey(item)] = item;\n    }\n  }\n  return valueByKey;\n}\n\nexport function useChoiceGroup<ITEM, EVENT>(\n  props: UseChoiceGroupProps<ITEM, EVENT>,\n): UseChoiceGroupValues<ITEM, EVENT> {\n  const formatedValue = formatValue(props.value, props.getKey, props.multiple);\n\n  const getChecked: GetChecked<ITEM> = (item) =>\n    Object.prototype.hasOwnProperty.call(formatedValue, props.getKey(item));\n\n  const getOnChange: GetOnChange<ITEM, EVENT> = (selectedItem) => (e) => {\n    if (isMultiple(props)) {\n      let newValue: ITEM[] | null;\n\n      if (getChecked(selectedItem)) {\n        const value = props.value || [];\n        newValue = value.filter(\n          (item) => props.getKey(item) !== props.getKey(selectedItem),\n        );\n        if (newValue.length === 0) {\n          newValue = null;\n        }\n      } else {\n        newValue = props.value ? [...props.value] : [];\n        newValue.push(selectedItem);\n      }\n      props.callBack?.(newValue, { e });\n    }\n\n    if (isNotMultiple(props)) {\n      props.callBack?.(selectedItem, { e });\n    }\n  };\n\n  return {\n    getOnChange,\n    getChecked,\n  };\n}\n"],"mappings":"s7CAAA,OAASA,QAAT,+BAgDA,QAASC,WAAT,CACEC,CADF,CAEgE,CAC9D,MAAOA,EAAM,CAACC,QACf,CAED,QAASC,cAAT,CACEF,CADF,CAEmE,CACjE,MAAO,CAACA,CAAM,CAACC,QAChB,CAED,QAASE,YAAT,CACEC,CADF,CAEEC,CAFF,CAGEJ,CAHF,CAIE,CACA,GAAMK,EAA+B,CAAG,EAAxC,CACA,GAAI,CAACR,QAAQ,CAACM,CAAD,CAAT,EAAwB,CAACG,KAAK,CAACC,OAAN,CAAcJ,CAAd,CAA7B,CACE,MAAOE,EAAP,CAEF,GAAMG,EAAK,CAAGR,CAAQ,CAAIG,CAAJ,CAA2B,CAACA,CAAD,CAAjD,CACA,GAAIK,CAAK,EAAmB,CAAf,CAAAA,CAAK,CAACC,MAAnB,CAA+B,oCACVD,CADU,MAC7B,2BAA0B,IAAfE,EAAe,SACxBL,CAAU,CAACD,CAAM,CAACM,CAAD,CAAP,CAAV,CAA2BA,CAC5B,CAH4B,+BAI9B,CACD,MAAOL,EACR,CAED,MAAO,SAASM,eAAT,CACLC,CADK,CAE8B,IAC7BC,EAAa,CAAGX,WAAW,CAACU,CAAK,CAACJ,KAAP,CAAcI,CAAK,CAACR,MAApB,CAA4BQ,CAAK,CAACZ,QAAlC,CADE,CAG7Bc,CAA4B,CAAG,SAACJ,CAAD,QACnCK,OAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCL,CAArC,CAAoDD,CAAK,CAACR,MAAN,CAAaM,CAAb,CAApD,CADmC,CAHF,CA8BnC,MAAO,CACLS,WAAW,CAzBiC,QAAxCA,YAAwC,CAACC,CAAD,QAAkB,UAACC,CAAD,CAAO,CACrE,GAAIvB,UAAU,CAACc,CAAD,CAAd,CAAuB,OACjBU,CADiB,CAGrB,GAAIR,CAAU,CAACM,CAAD,CAAd,CAA8B,CAC5B,GAAMZ,EAAK,CAAGI,CAAK,CAACJ,KAAN,EAAe,EAA7B,CACAc,CAAQ,CAAGd,CAAK,CAACe,MAAN,CACT,SAACb,CAAD,QAAUE,EAAK,CAACR,MAAN,CAAaM,CAAb,IAAuBE,CAAK,CAACR,MAAN,CAAagB,CAAb,CAAjC,CADS,CAFiB,CAKJ,CAApB,GAAAE,CAAQ,CAACb,MALe,GAM1Ba,CAAQ,CAAG,IANe,CAQ7B,CARD,IASEA,EAAQ,CAAGV,CAAK,CAACJ,KAAN,oBAAkBI,CAAK,CAACJ,KAAxB,EAAiC,EAT9C,CAUEc,CAAQ,CAACE,IAAT,CAAcJ,CAAd,CAVF,CAHqB,UAerBR,CAAK,CAACa,QAfe,qBAerB,OAAAb,CAAK,CAAYU,CAAZ,CAAsB,CAAED,CAAC,CAADA,CAAF,CAAtB,CACN,CAED,GAAIpB,aAAa,CAACW,CAAD,CAAjB,CAA0B,iBACxBA,CAAK,CAACa,QADkB,qBACxB,OAAAb,CAAK,CAAYQ,CAAZ,CAA0B,CAAEC,CAAC,CAADA,CAAF,CAA1B,CACN,CACF,CAtB6C,CAwBvC,CAELP,UAAU,CAAVA,CAFK,CAIR"}