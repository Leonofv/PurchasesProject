{"version":3,"file":"useHideElementsInLine.js","names":["useRef","useComponentSize","useRefs","useResizeObserved","createMap","length","moreIndex","Array","fill","map","_","index","calcElementsVisibleSize","elementsSizes","sum","useHideElementsInLine","busy","deps","elementsRefs","parentRef","parentSize","width","el","getComputedStyle","marginRight","marginLeft","parseInt","offsetWidth","hideByIndex","elementsSize","visibleMap"],"sources":["../../../../../src/hooks/useHideElementsInLine/useHideElementsInLine.ts"],"sourcesContent":["import { useRef } from 'react';\n\nimport { useComponentSize } from '##/hooks/useComponentSize';\nimport { useRefs } from '##/hooks/useRefs';\nimport { useResizeObserved } from '##/hooks/useResizeObserved';\n\nconst createMap = (length: number, moreIndex: number) =>\n  new Array(length).fill(null).map((_, index) => index !== moreIndex);\n\nconst calcElementsVisibleSize = (elementsSizes: number[], map: boolean[]) => {\n  let sum = 0;\n  for (let index = 0; index < map.length; index++) {\n    sum += map[index] ? elementsSizes[index] : 0;\n  }\n  return sum;\n};\n\nexport const useHideElementsInLine = <\n  ELEMENT extends HTMLElement = HTMLDivElement,\n  PARENT extends HTMLElement = HTMLDivElement,\n>(\n  length: number,\n  moreIndex = length - 1,\n  busy = 0,\n  deps: unknown[] = [],\n) => {\n  const elementsRefs = useRefs<ELEMENT>(length, deps);\n  const parentRef = useRef<PARENT>(null);\n  const parentSize = useComponentSize(parentRef).width;\n  const elementsSizes = useResizeObserved(elementsRefs, (el) => {\n    if (el) {\n      const { marginRight, marginLeft } = getComputedStyle(el);\n      return (\n        parseInt(marginRight, 10) + parseInt(marginLeft, 10) + el.offsetWidth\n      );\n    }\n\n    return 0;\n  });\n\n  const map = createMap(length, moreIndex);\n\n  const hideByIndex = (index: number) => {\n    if (!elementsSizes[index] || index === moreIndex) {\n      return;\n    }\n\n    const elementsSize = calcElementsVisibleSize(elementsSizes, map);\n\n    if (elementsSize + busy > parentSize) {\n      map[index] = false;\n      map[moreIndex] = true;\n    }\n  };\n\n  for (let index = 0; index < elementsSizes.length; index++) {\n    // Скрываем элемент слева  от `more`\n    hideByIndex(moreIndex - index);\n    // Скрываем элемент справа от `more`\n    hideByIndex(moreIndex + index);\n  }\n\n  return {\n    visibleMap: map,\n    elementsRefs,\n    parentRef,\n    elementsSizes,\n    parentSize,\n  };\n};\n"],"mappings":"AAAA,OAASA,MAAT,KAAuB,OAAvB,CAEA,OAASC,gBAAT,2BACA,OAASC,OAAT,kBACA,OAASC,iBAAT,4B,GAEMC,UAAS,CAAG,SAACC,CAAD,CAAiBC,CAAjB,QACZC,MAAJ,CAAUF,CAAV,EAAkBG,IAAlB,CAAuB,IAAvB,EAA6BC,GAA7B,CAAiC,SAACC,CAAD,CAAIC,CAAJ,QAAcA,EAAK,GAAKL,CAAxB,CAAjC,CADgB,C,CAGZM,uBAAuB,CAAG,SAACC,CAAD,CAA0BJ,CAA1B,CAA6C,CAE3E,OADIK,EAAG,CAAG,CACV,CAASH,CAAK,CAAG,CAAjB,CAAoBA,CAAK,CAAGF,CAAG,CAACJ,MAAhC,CAAwCM,CAAK,EAA7C,CACEG,CAAG,EAAIL,CAAG,CAACE,CAAD,CAAH,CAAaE,CAAa,CAACF,CAAD,CAA1B,CAAoC,CAA3C,CAEF,MAAOG,EACR,C,CAED,MAAO,IAAMC,sBAAqB,CAAG,SAInCV,CAJmC,CAQhC,CA8BH,OAjCAC,EAiCA,wDAjCYD,CAAM,CAAG,CAiCrB,CAhCAW,CAgCA,wDAhCO,CAgCP,CA/BAC,CA+BA,wDA/BkB,EA+BlB,CA7BMC,CAAY,CAAGhB,OAAO,CAAUG,CAAV,CAAkBY,CAAlB,CA6B5B,CA5BME,CAAS,CAAGnB,MAAM,CAAS,IAAT,CA4BxB,CA3BMoB,CAAU,CAAGnB,gBAAgB,CAACkB,CAAD,CAAhB,CAA4BE,KA2B/C,CA1BMR,CAAa,CAAGV,iBAAiB,CAACe,CAAD,CAAe,SAACI,CAAD,CAAQ,CAC5D,GAAIA,CAAJ,CAAQ,CACN,MAAoCC,gBAAgB,CAACD,CAAD,CAApD,CAAQE,CAAR,GAAQA,WAAR,CAAqBC,CAArB,GAAqBA,UAArB,CACA,MACEC,SAAQ,CAACF,CAAD,CAAc,EAAd,CAAR,CAA4BE,QAAQ,CAACD,CAAD,CAAa,EAAb,CAApC,CAAuDH,CAAE,CAACK,WAE7D,CAED,MAAO,EACR,CATsC,CA0BvC,CAfMlB,CAAG,CAAGL,SAAS,CAACC,CAAD,CAASC,CAAT,CAerB,CAbMsB,CAAW,CAAG,SAACjB,CAAD,CAAmB,CACrC,GAAKE,CAAa,CAACF,CAAD,CAAd,EAAyBA,CAAK,GAAKL,CAAvC,EAIA,GAAMuB,EAAY,CAAGjB,uBAAuB,CAACC,CAAD,CAAgBJ,CAAhB,CAA5C,CAEIoB,CAAY,CAAGb,CAAf,CAAsBI,CAN1B,GAOEX,CAAG,CAACE,CAAD,CAAH,GAPF,CAQEF,CAAG,CAACH,CAAD,CAAH,GARF,EAUD,CAED,CAASK,CAAK,CAAG,CAAjB,CAAoBA,CAAK,CAAGE,CAAa,CAACR,MAA1C,CAAkDM,CAAK,EAAvD,CAEEiB,CAAW,CAACtB,CAAS,CAAGK,CAAb,CAFb,CAIEiB,CAAW,CAACtB,CAAS,CAAGK,CAAb,CAJb,CAOA,MAAO,CACLmB,UAAU,CAAErB,CADP,CAELS,YAAY,CAAZA,CAFK,CAGLC,SAAS,CAATA,CAHK,CAILN,aAAa,CAAbA,CAJK,CAKLO,UAAU,CAAVA,CALK,CAOR,CApDM"}