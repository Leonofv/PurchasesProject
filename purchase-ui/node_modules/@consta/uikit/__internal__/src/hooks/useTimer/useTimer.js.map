{"version":3,"file":"useTimer.js","names":["useEffect","useRef","useState","initialConfig","interval","endTime","startTime","timerType","getTimeIsOver","time","useTimer","config","onTimeOver","intervalRef","pausedTimeRef","shouldResetTime","setShouldResetTime","setTime","isRunning","setIsRunning","cancelInterval","current","clearInterval","resetTime","createInterval","window","setInterval","previousTime","newTime","timerOver","pause","reset","start"],"sources":["../../../../../src/hooks/useTimer/useTimer.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\n\nexport type Timer = 'DECREMENTAL' | 'INCREMENTAL';\n\nexport type Config = {\n  /** interval in ms  */\n  interval: number;\n  /**  stop timer in ms */\n  endTime: number | null;\n  /**  start timer in ms */\n  startTime: number;\n  /** timer over callback */\n  onTimeOver?: () => void;\n  timerType: Timer;\n};\n\nexport type Values = {\n  isRunning: boolean;\n  pause: () => void;\n  reset: () => void;\n  start: () => void;\n  time: number;\n};\n\nconst initialConfig: Config = {\n  interval: 1000,\n  endTime: null,\n  startTime: 0,\n  timerType: 'INCREMENTAL',\n};\n\nfunction getTimeIsOver(\n  timerType: Timer,\n  time: number,\n  endTime: number | null,\n): boolean {\n  return (\n    endTime !== null &&\n    (timerType === 'INCREMENTAL' ? time >= endTime : time <= endTime)\n  );\n}\n\nexport function useTimer(config?: Partial<Config>): Values {\n  const { endTime, startTime, interval, timerType, onTimeOver } = {\n    ...initialConfig,\n    ...config,\n  };\n  const intervalRef = useRef<number | null>(null);\n  const pausedTimeRef = useRef<number | null>(null);\n  const [shouldResetTime, setShouldResetTime] = useState(false);\n  const [time, setTime] = useState(startTime);\n  const [isRunning, setIsRunning] = useState(false);\n\n  const cancelInterval = () => {\n    if (intervalRef.current) {\n      clearInterval(intervalRef.current);\n      intervalRef.current = null;\n      setIsRunning(false);\n    }\n  };\n\n  const timerOver = () => {\n    if (getTimeIsOver(timerType, time, endTime)) {\n      setShouldResetTime(true);\n      cancelInterval();\n      if (typeof onTimeOver === 'function') {\n        onTimeOver();\n      }\n    }\n  };\n\n  const pause = () => {\n    pausedTimeRef.current = time;\n\n    cancelInterval();\n  };\n\n  const resetTime = () => {\n    setTime(startTime);\n  };\n\n  const reset = () => {\n    pausedTimeRef.current = null;\n\n    cancelInterval();\n    resetTime();\n  };\n\n  const createInterval = () => {\n    setIsRunning(true);\n\n    intervalRef.current = window.setInterval(() => {\n      setTime((previousTime) => {\n        const newTime =\n          timerType === 'INCREMENTAL'\n            ? previousTime + interval\n            : previousTime - interval;\n\n        return newTime;\n      });\n    }, interval);\n  };\n\n  const start = () => {\n    if (intervalRef.current) {\n      return;\n    }\n\n    if (shouldResetTime) {\n      resetTime();\n      setShouldResetTime(false);\n    }\n\n    createInterval();\n  };\n\n  useEffect(() => {\n    cancelInterval();\n    return () => {\n      intervalRef.current && clearInterval(intervalRef.current);\n    };\n  }, []);\n  useEffect(timerOver, [timerType, time, endTime]);\n\n  return { isRunning, pause, reset, start, time };\n}\n"],"mappings":"suBAAA,OAASA,SAAT,CAAoBC,MAApB,CAA4BC,QAA5B,KAA4C,OAA5C,CAwBA,GAAMC,cAAqB,CAAG,CAC5BC,QAAQ,CAAE,GADkB,CAE5BC,OAAO,CAAE,IAFmB,CAG5BC,SAAS,CAAE,CAHiB,CAI5BC,SAAS,CAAE,aAJiB,CAA9B,CAOA,QAASC,cAAT,CACED,CADF,CAEEE,CAFF,CAGEJ,CAHF,CAIW,CACT,MACc,KAAZ,GAAAA,CAAO,GACQ,aAAd,GAAAE,CAAS,CAAqBE,CAAI,EAAIJ,CAA7B,CAAuCI,CAAI,EAAIJ,CADlD,CAGV,CAED,MAAO,SAASK,SAAT,CAAkBC,CAAlB,CAAoD,sCAEpDR,aAFoD,EAGpDQ,CAHoD,EACjDN,CADiD,GACjDA,OADiD,CACxCC,CADwC,GACxCA,SADwC,CAC7BF,CAD6B,GAC7BA,QAD6B,CACnBG,CADmB,GACnBA,SADmB,CACRK,CADQ,GACRA,UADQ,CAKnDC,CAAW,CAAGZ,MAAM,CAAgB,IAAhB,CAL+B,CAMnDa,CAAa,CAAGb,MAAM,CAAgB,IAAhB,CAN6B,GAOXC,QAAQ,IAPG,uBAOlDa,CAPkD,MAOjCC,CAPiC,QAQjCd,QAAQ,CAACI,CAAD,CARyB,uBAQlDG,CARkD,MAQ5CQ,CAR4C,QASvBf,QAAQ,IATe,uBASlDgB,CATkD,MASvCC,CATuC,MAWnDC,CAAc,CAAG,UAAM,CACvBP,CAAW,CAACQ,OADW,GAEzBC,aAAa,CAACT,CAAW,CAACQ,OAAb,CAFY,CAGzBR,CAAW,CAACQ,OAAZ,CAAsB,IAHG,CAIzBF,CAAY,IAJa,CAM5B,CAjBwD,CAmCnDI,CAAS,CAAG,UAAM,CACtBN,CAAO,CAACX,CAAD,CACR,CArCwD,CA8CnDkB,CAAc,CAAG,UAAM,CAC3BL,CAAY,IADe,CAG3BN,CAAW,CAACQ,OAAZ,CAAsBI,MAAM,CAACC,WAAP,CAAmB,UAAM,CAC7CT,CAAO,CAAC,SAACU,CAAD,CAAkB,CACxB,GAAMC,EAAO,CACG,aAAd,GAAArB,CAAS,CACLoB,CAAY,CAAGvB,CADV,CAELuB,CAAY,CAAGvB,CAHrB,CAKA,MAAOwB,EACR,CAPM,CAQR,CATqB,CASnBxB,CATmB,CAUvB,CA3DwD,CAkFzD,MARAJ,UAAS,CAAC,UAAM,CAEd,MADAoB,EAAc,EACd,CAAO,UAAM,CACXP,CAAW,CAACQ,OAAZ,EAAuBC,aAAa,CAACT,CAAW,CAACQ,OAAb,CACrC,CACF,CALQ,CAKN,EALM,CAQT,CAFArB,SAAS,CA7DS,QAAZ6B,UAAY,EAAM,CAClBrB,aAAa,CAACD,CAAD,CAAYE,CAAZ,CAAkBJ,CAAlB,CADK,GAEpBW,CAAkB,IAFE,CAGpBI,CAAc,EAHM,CAIM,UAAtB,QAAOR,EAJS,EAKlBA,CAAU,EALQ,CAQvB,CAqDQ,CAAY,CAACL,CAAD,CAAYE,CAAZ,CAAkBJ,CAAlB,CAAZ,CAET,CAAO,CAAEa,SAAS,CAATA,CAAF,CAAaY,KAAK,CArDX,QAARA,MAAQ,EAAM,CAClBhB,CAAa,CAACO,OAAd,CAAwBZ,CADN,CAGlBW,CAAc,EACf,CAiDM,CAAoBW,KAAK,CA3ClB,QAARA,MAAQ,EAAM,CAClBjB,CAAa,CAACO,OAAd,CAAwB,IADN,CAGlBD,CAAc,EAHI,CAIlBG,CAAS,EACV,CAsCM,CAA2BS,KAAK,CArBzB,QAARA,MAAQ,EAAM,CACdnB,CAAW,CAACQ,OADE,GAKdN,CALc,GAMhBQ,CAAS,EANO,CAOhBP,CAAkB,IAPF,EAUlBQ,CAAc,EAVI,CAWnB,CAUM,CAAkCf,IAAI,CAAJA,CAAlC,CACR"}