{"version":3,"file":"getGroups.js","names":["defaultGroupKey","getItemGroupKeyGuard","getter","item","noGroupKey","key","getGroups","items","getItemGroupKey","groups","getGroupKey","sortGroups","groupIndex","resultGroups","itemGroupKey","resultGroupIndex","findIndex","group","push","g","resultGroup","sort","a","b","getCountedGroups","values","selectAll","getItemKey","getItemDisabled","copyGroups","forEach","index","totalCount","checkedCount","find","el","__optionSelctAll","groupKey"],"sources":["../../../../src/utils/getGroups.ts"],"sourcesContent":["export type Group<ITEM, GROUP> = {\n  items: ITEM[];\n  key: string | number;\n  group?: GROUP;\n  groupIndex: number;\n};\n\nexport type SelectAllItem = {\n  checkedCount: number;\n  totalCount: number;\n  groupKey: string | number;\n  __optionSelctAll: true;\n};\n\nexport type CountedGroup<ITEM, GROUP> = Omit<Group<ITEM, GROUP>, 'items'> & {\n  items: Array<SelectAllItem | ITEM>;\n};\n\ntype GetItemGroupKey<ITEM> = (item: ITEM) => string | number | undefined;\ntype GetItemKey<ITEM> = (item: ITEM) => string | number | undefined;\ntype GetItemDisabled<ITEM> = (item: ITEM) => boolean | undefined;\ntype GetGroupKey<GROUP> = (item: GROUP) => string | number | undefined;\ntype SortGroups<ITEM, GROUP> = (\n  a: Group<ITEM, GROUP>,\n  b: Group<ITEM, GROUP>,\n) => number;\ntype GetGroupsResult<ITEM, GROUP> = Group<ITEM, GROUP>[];\n\nexport const defaultGroupKey = 'no-group';\n\nconst getItemGroupKeyGuard = <ITEM>(\n  getter: GetGroupKey<ITEM>,\n  item: ITEM,\n  noGroupKey: string,\n) => {\n  const key = getter(item);\n\n  return typeof key === 'undefined' ? noGroupKey : key;\n};\n\n/**\n * @param items список который нужно групировать\n * @param getItemGroupKey признак принадлежности к группе\n * @param groups список групп\n * @param getGroupKey результат функции должен вернуть уникальный ключ группы\n * @param sortGroups сортировка групп\n * @param noGroupKey ключ группы которая создаться если item небудет принадлежать ни к одной из групп\n */\n\nexport function getGroups<ITEM, GROUP>(\n  items: ITEM[],\n  getItemGroupKey: GetItemGroupKey<ITEM> | undefined,\n  groups: GROUP[] | undefined,\n  getGroupKey: GetGroupKey<GROUP> | undefined,\n  sortGroups: SortGroups<ITEM, GROUP> | undefined,\n  noGroupKey = defaultGroupKey,\n): GetGroupsResult<ITEM, GROUP> {\n  if (typeof getItemGroupKey !== 'function') {\n    return [{ items, key: noGroupKey, groupIndex: -1 }];\n  }\n\n  const resultGroups: GetGroupsResult<ITEM, GROUP> = [];\n  for (const item of items) {\n    const itemGroupKey = getItemGroupKeyGuard(\n      getItemGroupKey,\n      item,\n      noGroupKey,\n    );\n    const resultGroupIndex = resultGroups.findIndex(\n      (group) => group.key === itemGroupKey,\n    );\n\n    if (resultGroupIndex >= 0) {\n      resultGroups[resultGroupIndex].items.push(item);\n    } else {\n      const groupIndex =\n        getGroupKey && groups\n          ? groups.findIndex((g) => getGroupKey(g) === itemGroupKey)\n          : -1;\n\n      const resultGroup: Group<ITEM, GROUP> = {\n        key: itemGroupKey,\n        items: [item],\n        groupIndex,\n        group: groups ? groups[groupIndex] : undefined,\n      };\n\n      resultGroups.push(resultGroup);\n    }\n  }\n\n  if (typeof sortGroups === 'function') {\n    resultGroups.sort(sortGroups);\n  } else if (groups && getGroupKey) {\n    resultGroups.sort((a, b) => {\n      if (a.groupIndex > b.groupIndex) return 1;\n      if (a.groupIndex < b.groupIndex) return -1;\n      return 0;\n    });\n  }\n\n  return resultGroups;\n}\n\nexport function getCountedGroups<ITEM, GROUP>(\n  groups: GetGroupsResult<ITEM, GROUP>,\n  values: ITEM[] | undefined | null,\n  selectAll: boolean,\n  getItemKey: GetItemKey<ITEM>,\n  getItemDisabled?: GetItemDisabled<ITEM>,\n): CountedGroup<ITEM, GROUP>[] {\n  const copyGroups: CountedGroup<ITEM, GROUP>[] = [...groups];\n  if (selectAll) {\n    groups.forEach((group, index) => {\n      let totalCount = 0;\n      let checkedCount = 0;\n      group.items.forEach((item) => {\n        if (!(getItemDisabled && getItemDisabled?.(item))) {\n          totalCount += 1;\n        }\n        if (values?.find((el) => getItemKey(item) === getItemKey(el))) {\n          checkedCount += 1;\n        }\n      });\n      copyGroups[index].items = [\n        {\n          __optionSelctAll: true,\n          totalCount,\n          groupKey: group.key,\n          checkedCount,\n        },\n        ...copyGroups[index].items,\n      ];\n    });\n  }\n  return copyGroups;\n}\n"],"mappings":"8tCA4BA,MAAO,IAAMA,gBAAe,CAAG,UAAxB,CAEP,GAAMC,qBAAoB,CAAG,SAC3BC,CAD2B,CAE3BC,CAF2B,CAG3BC,CAH2B,CAIxB,CACH,GAAMC,EAAG,CAAGH,CAAM,CAACC,CAAD,CAAlB,CAEA,MAAsB,WAAf,QAAOE,EAAP,CAA6BD,CAA7B,CAA0CC,CAClD,CARD,CAmBA,MAAO,SAASC,UAAT,CACLC,CADK,CAELC,CAFK,CAGLC,CAHK,CAILC,CAJK,CAKLC,CALK,CAOyB,IAD9BP,EAC8B,wDADjBJ,eACiB,CAC9B,GAA+B,UAA3B,QAAOQ,EAAX,CACE,MAAO,CAAC,CAAED,KAAK,CAALA,CAAF,CAASF,GAAG,CAAED,CAAd,CAA0BQ,UAAU,CAAE,CAAC,CAAvC,CAAD,CAAP,CAF4B,MAKxBC,CAA0C,CAAG,EALrB,8BAMXN,CANW,gCAMnBJ,EANmB,SAOtBW,CAAY,CAAGb,oBAAoB,CACvCO,CADuC,CAEvCL,CAFuC,CAGvCC,CAHuC,CAPb,CAYtBW,CAAgB,CAAGF,CAAY,CAACG,SAAb,CACvB,SAACC,CAAD,QAAWA,EAAK,CAACZ,GAAN,GAAcS,CAAzB,CADuB,CAZG,CAgB5B,GAAwB,CAApB,EAAAC,CAAJ,CACEF,CAAY,CAACE,CAAD,CAAZ,CAA+BR,KAA/B,CAAqCW,IAArC,CAA0Cf,CAA1C,CADF,KAEO,IACCS,EAAU,CACdF,CAAW,EAAID,CAAf,CACIA,CAAM,CAACO,SAAP,CAAiB,SAACG,CAAD,QAAOT,EAAW,CAACS,CAAD,CAAX,GAAmBL,CAA1B,CAAjB,CADJ,CAEI,CAAC,CAJF,CAMCM,CAA+B,CAAG,CACtCf,GAAG,CAAES,CADiC,CAEtCP,KAAK,CAAE,CAACJ,CAAD,CAF+B,CAGtCS,UAAU,CAAVA,CAHsC,CAItCK,KAAK,CAAER,CAAM,CAAGA,CAAM,CAACG,CAAD,CAAT,OAJyB,CANnC,CAaLC,CAAY,CAACK,IAAb,CAAkBE,CAAlB,CACD,CAhC2B,EAM9B,8BAN8B,+BA6C9B,MAV0B,UAAtB,QAAOT,EAUX,CATEE,CAAY,CAACQ,IAAb,CAAkBV,CAAlB,CASF,CARWF,CAAM,EAAIC,CAQrB,EAPEG,CAAY,CAACQ,IAAb,CAAkB,SAACC,CAAD,CAAIC,CAAJ,CAAU,OACtBD,EAAC,CAACV,UAAF,CAAeW,CAAC,CAACX,UADK,CACc,CADd,CAEtBU,CAAC,CAACV,UAAF,CAAeW,CAAC,CAACX,UAFK,CAEc,CAAC,CAFf,CAGnB,CACR,CAJD,CAOF,CAAOC,CACR,CAED,MAAO,SAASW,iBAAT,CACLf,CADK,CAELgB,CAFK,CAGLC,CAHK,CAILC,CAJK,CAKLC,CALK,CAMwB,CAC7B,GAAMC,EAAuC,oBAAOpB,CAAP,CAA7C,CAwBA,MAvBIiB,EAuBJ,EAtBEjB,CAAM,CAACqB,OAAP,CAAe,SAACb,CAAD,CAAQc,CAAR,CAAkB,IAC3BC,EAAU,CAAG,CADc,CAE3BC,CAAY,CAAG,CAFY,CAG/BhB,CAAK,CAACV,KAAN,CAAYuB,OAAZ,CAAoB,SAAC3B,CAAD,CAAU,CACtByB,CAAe,SAAIA,CAAJ,WAAIA,CAAJ,EAAIA,CAAe,CAAGzB,CAAH,CADZ,GAE1B6B,CAAU,EAAI,CAFY,SAIxBP,CAJwB,WAIxBA,CAJwB,EAIxBA,CAAM,CAAES,IAAR,CAAa,SAACC,CAAD,QAAQR,EAAU,CAACxB,CAAD,CAAV,GAAqBwB,CAAU,CAACQ,CAAD,CAAvC,CAAb,CAJwB,GAK1BF,CAAY,EAAI,CALU,CAO7B,CAPD,CAH+B,CAW/BJ,CAAU,CAACE,CAAD,CAAV,CAAkBxB,KAAlB,EACE,CACE6B,gBAAgB,GADlB,CAEEJ,UAAU,CAAVA,CAFF,CAGEK,QAAQ,CAAEpB,CAAK,CAACZ,GAHlB,CAIE4B,YAAY,CAAZA,CAJF,CADF,4BAOKJ,CAAU,CAACE,CAAD,CAAV,CAAkBxB,KAPvB,EASD,CApBD,CAsBF,CAAOsB,CACR"}